<!DOCTYPE html>
<html lang="en"><head>
<script src="slides_en_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides_en_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides_en_files/libs/quarto-html/popper.min.js"></script>
<script src="slides_en_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides_en_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides_en_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides_en_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Antoine Géré">
  <title>Statistics and data analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="slides_en_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="slides_en_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="slides_en_files/libs/revealjs/dist/theme/quarto-2f366650f320edcfcf53d73c80250a32.css">
  <link href="slides_en_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="slides_en_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="slides_en_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="slides_en_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistics and data analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Antoine Géré 
</div>
</div>
</div>

</section>
<section>
<section id="general-informations" class="title-slide slide level1 center">
<h1>General informations</h1>

</section>
<section id="organization" class="slide level2">
<h2>Organization</h2>
<p><br></p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">S2</th>
<th style="text-align: center;">S3</th>
<th style="text-align: center;">S4</th>
<th style="text-align: center;">S5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lectures</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
</tr>
<tr class="even">
<td>Tutorials</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
</tr>
<tr class="odd">
<td>tot.</td>
<td style="text-align: center;">16 (24h)</td>
<td style="text-align: center;">16 (24h)</td>
<td style="text-align: center;">16 (24h)</td>
<td style="text-align: center;">16 (24h)</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li><strong>Lectures</strong> : no need to bring your personal computer</li>
<li><strong>Tutorials</strong> : bring your personal computer</li>
</ul>
<p><br></p>
<p><a href="https://ant0in3g.github.io/sTa7.html" class="uri">https://ant0in3g.github.io/sTa7.html</a> <span class="math inline">\(\to\)</span> look at your stickers !</p>
</div><div class="column" style="width:30%;">
<p><br> <a href="https://ant0in3g.github.io/sTa7.htm"><img data-src="img/webpage-antoine-gere.png" style="width:50.0%"></a></p>
</div></div>
</section>
<section id="evaluations-and-group-projets" class="slide level2">
<h2>Evaluations and Group projets</h2>
<p><br><br></p>
<div class="columns">
<div class="column" style="width:32%;">
<h3 id="evaluations">Evaluations</h3>
<p>For each semester :</p>
<ul>
<li>One mid-semester exam (1h30)</li>
<li>One final exam (1h30)</li>
</ul>
</div><div class="column" style="width:6%;">

</div><div class="column" style="width:62%;">
<h3 id="group-projets">Group projets</h3>
<ul>
<li><p><strong>Semester 2 :</strong></p>
<div style="text-align:center;">
<p><a href="https://ant0in3g.github.io/sTa7/PASD/PASD.html"><strong>P</strong>remière <strong>A</strong>nalyse en <strong>S</strong>tatistique <strong>D</strong>escriptive (PASD)</a></p>
</div></li>
<li><p><strong>Semester 4 :</strong></p>
<div style="text-align:center;">
<p><a href="https://ant0in3g.github.io/sTa7/PEAD/PEAD.html"><strong>P</strong>remière <strong>E</strong>xpérience en <strong>A</strong>nalyse de <strong>D</strong>onnées (PEAD)</a></p>
</div></li>
<li><p><strong>Semester 6 :</strong></p>
<div style="text-align:center;">
<p><a href="https://ant0in3g.github.io/sTa7/PIDEx/PIDEx.html"><strong>P</strong>rojet d’<strong>I</strong>nitiation à la <strong>D</strong>émarche <strong>Ex</strong>périmentale (PIDEx)</a></p>
</div></li>
</ul>
</div></div>
</section>
<section id="resources-and-onedrive-folder" class="slide level2">
<h2>Resources and OneDrive folder</h2>
<h3 id="resources">Resources</h3>
<ul>
<li><p><a href="https://ant0in3g.github.io/sTa7/Slides/slides.html">Slides du cours</a></p></li>
<li><p><a href="https://ant0in3g.github.io/sTa7/LectureStat/index.html">Cours complet de Statistiques et analyse de données</a> (en construction)</p></li>
<li><p><a href="https://ant0in3g.github.io/sTa7/td-s.html">Travaux dirigés</a></p></li>
<li><p><a href="https://ant0in3g.github.io/sTa7/examens.html">Sujets d’examens corrigées des années passées</a></p></li>
<li><p><a href="https://www.statlearning.com/">An Introduction to Statistical Learning from the Stanford University</a> with a <a href="https://www.youtube.com/playlist?list=PLoROMvodv4rOzrYsAxzQyHb8n_RWNuS1e">YouTube playlist</a> of the lectures</p></li>
</ul>
<h3 id="shared-onedrive-folder">Shared OneDrive folder</h3>
<p><em>A OneDrive folder has been shared with every student</em></p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>To Do !</strong></p>
</div>
<div class="callout-content">
<p><a href="https://ant0in3g.github.io/sTa7/orga.html">Synchornize this folder on your laptop <strong>OR</strong> create a shortcut on your own OneDrvive</a></p>
</div>
</div>
</div>
</section></section>
<section>
<section id="introduction-to-statistics-andwith-r" class="title-slide slide level1 center">
<h1>Introduction to statistics and/with R</h1>
<p><br></p>
<ul>
<li><strong>Data</strong> : interesting</li>
</ul>
<p><span class="math inline">\(\to\)</span> they help us <strong>understand the world</strong> !</p>
<p><br></p>
<ul>
<li><strong>Statistics</strong> : fundamental in <strong>science</strong></li>
</ul>
<p><span class="math inline">\(\to\)</span> needed in the design, analysis, and interpretation of experiments !</p>
</section>
<section id="a-brief-intro-to-r-and-rstudio" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> A brief intro to R and RStudio</h2>
<p><img data-src="img/R_RStudio_LogoS.png" style="width:50.0%"></p>
<ul>
<li>Free open source language</li>
<li>Built to do statistics</li>
<li>Updated by the mathematician from all over the world</li>
<li>Amazing graphics !</li>
<li>Widely used in biology, agronomy, economy, …</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>R and RStudio</strong></p>
</div>
<div class="callout-content">
<p><strong>Learn it, love it, use it !</strong></p>
</div>
</div>
</div>
<p><br></p>
<h3 id="installation-of-r-and-rstudio">Installation of R and RStudio</h3>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>To Do !</strong></p>
</div>
<div class="callout-content">
<p>Install R and RStudio for next class !</p>
</div>
</div>
</div>
<p><br></p>
<h3 id="basics-of-r-and-rstudio">Basics of R and RStudio</h3>
<p>A very great video to learn the basics of <strong>R</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/yZ0bV2Afkjc?si=noUaUWMekoOQOZfo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<h3 id="good-habits">Good habits</h3>
<ul>
<li>create a <strong>project</strong> on RStudio</li>
<li>create ALWAYS <strong>4 folders</strong> :
<ul>
<li><code>data_raw</code></li>
<li><code>data</code></li>
<li><code>img</code></li>
<li><code>doc</code></li>
</ul></li>
<li>Use the <code>help</code> function ! … and also <code>chat GPT</code> …<br>
<strong>WARNING ! It often writes code wayyyy too complicated !</strong></li>
<li><strong>What you see in your OneDrive folder</strong> :</li>
</ul>
<p><img data-src="img/onedrive-folder.png" style="width:50.0%"></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Launch RStudio</strong></p>
</div>
<div class="callout-content">
<p>Always launch your <strong>RStudio project</strong> with</p>
<p><img data-src="img/launch-RStudio.png" style="width:150.0%"></p>
</div>
</div>
</div>
<p><br></p>
<h3 id="using-rstudio">Using RStudio</h3>
<p><img data-src="img/rstudio-1st-time.png"></p>
<p><br></p>
<h3 id="import-data-into-rstudio">Import DATA into RStudio</h3>
<ul>
<li>Data used for this class : <a href="https://github.com/ant0in3g/ant0in3g.github.io/blob/main/sTa7/Slides/data_raw/Data.Lecture.xlsx"><strong><code>Data.Lecture.xlsx</code></strong></a></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><strong>You can download it by clicking on <a href="https://github.com/ant0in3g/ant0in3g.github.io/blob/main/sTa7/Slides/data_raw/Data.Lecture.xlsx"><strong><code>Data.Lecture.xlsx</code></strong></a> !</strong></p>
<p><img data-src="img/download-Data.Lecture.png" style="width:100.0%"></p>
</div>
</div>
</div>
<ul>
<li>Import data from an <strong>excel</strong> file</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href=""></a>my.data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data_raw/Data.Lecture.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Possible to import data from many more file formats …</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Let’s get started</strong></p>
</div>
<div class="callout-content">
<p><strong>NOW “doing statistics” can get started !</strong></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="exploring-data" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Exploring data</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Def.</strong></p>
</div>
<div class="callout-content">
<ul>
<li>A <strong>variable</strong> <span class="math inline">\(X\)</span> is any characteristic observed in a study.</li>
<li>The data values that we observe for a variable are called <strong>observations</strong></li>
</ul>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:36%;">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Qualitative / Categorical Variable</strong></p>
</div>
<div class="callout-content">
<p>A variable is called <strong>qualitative</strong> if <strong>each observation belongs</strong> to a <strong>set of distinct categories</strong></p>
<ul>
<li><p><strong>Nominal</strong> : Categories are disconnected. (<em>Examples : Hair Color, Animal Species, …</em>)</p></li>
<li><p><strong>Ordinal</strong> : Categories are ranked (<em>Example : Level of Education, …</em>)</p></li>
</ul>
</div>
</div>
</div>
</div><div class="column" style="width:4%;">

</div><div class="column" style="width:60%;">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Quantitative / Numerical Variable</strong></p>
</div>
<div class="callout-content">
<p>A variable is called <strong>quantitative</strong> if observations on it take numerical values that represent different magnitudes of the variable</p>
<ul>
<li><p><strong>Discrete</strong> : the variable assume values in a countable set (<em>Examples : Number of episode in a series, Grades, …</em>)</p></li>
<li><p><strong>Continuous</strong> : the variable assume values in a continuous set (<em>Examples : Time, most physical measurements, …</em>)</p></li>
</ul>
</div>
</div>
</div>
</div></div>
<p><br></p>
<p>In a dataset (sample of a population) we have measurements of variables for different individuals.</p>
<ul>
<li><strong>Unit / individual</strong> : A member of a population</li>
<li><strong>Population</strong> : The collection of all individuals / units that we want to know more about</li>
<li><strong>Sample</strong> : The subset of the population we observe</li>
<li><strong>Modality</strong> : The distinct values or categories that the variable can take</li>
</ul>
<p><br></p>
<p>Before making advanced statistics with our data it is essential to examine all our variables !</p>
<p>Why ? To <em>“listen”</em> to the data :</p>
<ul>
<li>to catch mistakes</li>
<li>to see patterns in the data</li>
<li>to find violations of statistical assumptions</li>
<li>to generate hypotheses</li>
<li>… and because if you don’t, you will have trouble later !</li>
</ul>
<p><br></p>
<ul>
<li>We will recall notions of <strong>descriptive Statistics with R</strong><br>
</li>
<li>This has been written using this <a href="https://odr.inrae.fr/intranet/carto/cartowiki/index.php/Statistiques_descriptives_avec_R">webpage (INRAE)</a></li>
</ul>
<p><br></p>
<p>We will use the dataset <code>iris</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">data</span>(iris)</span>
<span id="cb2-2"><a href=""></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">dim</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150   5</code></pre>
</div>
</div>
<p>There are 5 variables and 150 individuals.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>4 quantitative variables :</p>
<ul>
<li><code>Sepal.Length</code></li>
<li><code>Sepal.Width</code><br>
</li>
<li><code>Petal.Length</code><br>
</li>
<li><code>Petal.Width</code></li>
</ul>
</div><div class="column" style="width:50%;">
<p>1 qualitative variable :</p>
<ul>
<li><code>Species</code></li>
</ul>
<p><img data-src="img/iris.png" style="width:50.0%"></p>
</div></div>
</section>
<section id="univariate-statistics" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Univariate statistics</h2>
<p>To have a global view : <code>summary</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">summary</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
</div>
<p>The command <code>summary</code> gives us :</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>for the quantitative variables :
<ul>
<li>the minimum</li>
<li>the 1st quartile</li>
<li>the median</li>
<li>the mean</li>
<li>the 3rd quartile</li>
<li>the maximum</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>for the qualitative variables :
<ul>
<li>the number of observations in each category</li>
</ul></li>
</ul>
</div></div>
<p><strong>Using <code>describe</code> for data summaries</strong> :</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb8-2"><a href=""></a><span class="fu">describe</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>iris 

 5  Variables      150  Observations
--------------------------------------------------------------------------------
Sepal.Length 
       n  missing distinct     Info     Mean  pMedian      Gmd      .05 
     150        0       35    0.998    5.843      5.8   0.9462    4.600 
     .10      .25      .50      .75      .90      .95 
   4.800    5.100    5.800    6.400    6.900    7.255 

lowest : 4.3 4.4 4.5 4.6 4.7, highest: 7.3 7.4 7.6 7.7 7.9
--------------------------------------------------------------------------------
Sepal.Width 
       n  missing distinct     Info     Mean  pMedian      Gmd      .05 
     150        0       23    0.992    3.057     3.05   0.4872    2.345 
     .10      .25      .50      .75      .90      .95 
   2.500    2.800    3.000    3.300    3.610    3.800 

lowest : 2   2.2 2.3 2.4 2.5, highest: 3.9 4   4.1 4.2 4.4
--------------------------------------------------------------------------------
Petal.Length 
       n  missing distinct     Info     Mean  pMedian      Gmd      .05 
     150        0       43    0.998    3.758     3.65    1.979     1.30 
     .10      .25      .50      .75      .90      .95 
    1.40     1.60     4.35     5.10     5.80     6.10 

lowest : 1   1.1 1.2 1.3 1.4, highest: 6.3 6.4 6.6 6.7 6.9
--------------------------------------------------------------------------------
Petal.Width 
       n  missing distinct     Info     Mean  pMedian      Gmd      .05 
     150        0       22     0.99    1.199      1.2   0.8676      0.2 
     .10      .25      .50      .75      .90      .95 
     0.2      0.3      1.3      1.8      2.2      2.3 

lowest : 0.1 0.2 0.3 0.4 0.5, highest: 2.1 2.2 2.3 2.4 2.5
--------------------------------------------------------------------------------
Species 
       n  missing distinct 
     150        0        3 
                                           
Value          setosa versicolor  virginica
Frequency          50         50         50
Proportion      0.333      0.333      0.333
--------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>The <code>Hmisc</code> package provides the <code>describe</code> function to quickly summarize a dataset.</li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<ul>
<li>For <strong>quantitative variables</strong>, it reports :
<ul>
<li>number of observations</li>
<li>missing values</li>
<li>mean</li>
<li>quantiles (5%, 10%, 25%, 50%, 75%, 90%, 95%)</li>
<li>5 lowest and 5 highest values</li>
</ul></li>
</ul>
</div><div class="column" style="width:45%;">
<ul>
<li>For <strong>qualitative variables</strong>, it reports :
<ul>
<li>number of observations</li>
<li>missing values</li>
<li>number of modalities</li>
<li>frequency and proportion of each modality</li>
</ul></li>
</ul>
</div></div>
<p><br></p>
<h3 id="quantitative-variables">Quantitative variables</h3>
<p>For each quantitative variable, it is also possible to obtain the following statistics separately.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>the sum of all the modalities in <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">sum</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 876.5</code></pre>
</div>
</div>
<ul>
<li>the mean of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.843333</code></pre>
</div>
</div>
<ul>
<li>the variance of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">var</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6856935</code></pre>
</div>
</div>
<ul>
<li>the standard deviation of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">sd</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8280661</code></pre>
</div>
</div>
<ul>
<li>the minimum of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="fu">min</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.3</code></pre>
</div>
</div>
</div><div class="column" style="width:8%;">

</div><div class="column" style="width:42%;">
<ul>
<li>the maximum of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">max</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.9</code></pre>
</div>
</div>
<ul>
<li>the median of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">median</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.8</code></pre>
</div>
</div>
<ul>
<li>the quantiles of the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">quantile</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 4.3  5.1  5.8  6.4  7.9 </code></pre>
</div>
</div>
<ul>
<li>the number of modalities in the variable <code>Sepal.Length</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">length</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150</code></pre>
</div>
</div>
</div></div>
<p><br></p>
<p><strong>Chart representations</strong></p>
<ul>
<li>A first representation is to use a <strong>boxplot</strong><br>
</li>
<li>Graphical way to summarize a <strong>quantitative variable</strong></li>
<li>Show its <strong>distribution, central tendency, and spread</strong>, including outliers.</li>
</ul>
<p>Components of a Boxplot :</p>
<ol type="1">
<li><strong>Median (Q2)</strong>
<ul>
<li>The line inside the box represents the <strong>median</strong> — the middle value of the data.<br>
</li>
<li>It divides the data into two equal sets.</li>
</ul></li>
<li><strong>Quartiles (Q1 and Q3)</strong>
<ul>
<li><strong>Q1 (bottom of the box)</strong>: 25% of the data is below this value.<br>
</li>
<li><strong>Q3 (top of the box)</strong>: 75% of the data is below this value.<br>
</li>
<li>The box shows the <strong>interquartile range (IQR = Q3 − Q1)</strong>, which contains the middle 50% of the data.</li>
</ul></li>
<li><strong>Whiskers</strong>
<ul>
<li>Lines extending from the box to the <strong>minimum and maximum values</strong> within a certain range (usually 1.5 × IQR from Q1 and Q3)</li>
</ul></li>
<li><strong>Outliers</strong>
<ul>
<li>Points outside the whiskers plotted individually.<br>
</li>
<li>Represent values that are unusually high or low compared to the rest of the data.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"yellow"</span>),<span class="at">main =</span> <span class="st">"Boxplot"</span>, <span class="at">ylab =</span> <span class="st">"Sepal Length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Also possible to represent many boxplot on the same plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a><span class="fu">boxplot</span>(iris[,<span class="fu">c</span>(<span class="st">'Sepal.Length'</span>,<span class="st">'Sepal.Width'</span>,<span class="st">'Petal.Length'</span>,<span class="st">'Petal.Width'</span>)],</span>
<span id="cb29-2"><a href=""></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"yellow"</span>),                 <span class="co">#Pour la couleur</span></span>
<span id="cb29-3"><a href=""></a>        <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Boxplot"</span>),     <span class="co">#Pour le titre</span></span>
<span id="cb29-4"><a href=""></a>        <span class="at">ylab =</span> <span class="st">"Length and width"</span>)              <span class="co">#Pour le titre de l’axe des ordonnées</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-15-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>A usual graph is the <strong>histogram</strong>. It is a type of <strong>bar graph</strong> that represents the <strong>distribution of a quantitative variable</strong>.</p>
<p><strong>Key Features</strong></p>
<ul>
<li><p><strong>Bins (Intervals)</strong>:<br>
The x-axis is divided into continuous intervals called <strong>bins</strong>, each representing a <strong>range of values</strong>.</p></li>
<li><p><strong>Frequency</strong>:<br>
The y-axis shows the <strong>number of observations</strong> (frequency) in each bin.</p></li>
<li><p><strong>Bars</strong>:<br>
Each bin is represented by a <strong>bar</strong>.<br>
The <strong>height of the bar</strong> corresponds to the <strong>frequency</strong>.<br>
Bars <strong>touch each other</strong> because the data is continuous.</p></li>
<li><p><strong>Distribution Shape</strong>:<br>
A histogram helps visualize the shape of the data:</p>
<ul>
<li><strong>Symmetric</strong> or <strong>skewed</strong><br>
</li>
<li><strong>Uniform</strong> (flat)<br>
</li>
<li><strong>Bimodal</strong> (two peaks)<br>
</li>
<li><strong>Unimodal</strong> (one peak)</li>
</ul></li>
</ul>
<p><strong>Why using an histogram ?</strong></p>
<ul>
<li>Understand the <strong>shape of the data</strong>.<br>
</li>
<li>Detect <strong>patterns, skewness, or clusters</strong>.<br>
</li>
<li>Identify <strong>outliers</strong> or unusual gaps.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Length, </span>
<span id="cb30-2"><a href=""></a>      <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>),</span>
<span id="cb30-3"><a href=""></a>      <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Histogramme pour la variable Sepal.Length"</span>),</span>
<span id="cb30-4"><a href=""></a>      <span class="at">ylab =</span> <span class="st">"Effectifs"</span>,</span>
<span id="cb30-5"><a href=""></a>      <span class="at">xlab =</span> <span class="st">"Longueur du sépale"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-16-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="qualitative-variables">Qualitative variables</h3>
<ul>
<li>the command <code>table</code> summarize categorical data by counting the frequency of each unique value</li>
<li>It creates a contingency table, which is very useful in statistics for understanding distributions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a>table_Species<span class="ot">&lt;-</span><span class="fu">table</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb31-2"><a href=""></a>table_Species</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    setosa versicolor  virginica 
        50         50         50 </code></pre>
</div>
</div>
<p>The same with the proportions :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="fu">prop.table</span>(table_Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    setosa versicolor  virginica 
 0.3333333  0.3333333  0.3333333 </code></pre>
</div>
</div>
<p>and finally we can draw the bar plot for this variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">barplot</span>(table_Species, <span class="at">main=</span><span class="st">"Barplot for the species"</span>, </span>
<span id="cb35-2"><a href=""></a>        <span class="at">xlab=</span><span class="st">"Nombre d'iris"</span>,</span>
<span id="cb35-3"><a href=""></a>        <span class="at">col=</span><span class="st">"orange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-statistics" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Bivariate statistics</h2>
<ul>
<li>Summarize and describe the relationship between two variables<br>
</li>
<li>Explore how one variable changes with respect to another</li>
</ul>
<p>Three types of situations :</p>
<ol type="1">
<li>Quantitative – Quantitative : Both variables are numeric</li>
<li>Quantitative – Qualitative : One numeric, one categorical</li>
<li>Qualitative – Qualitative : Both categorical</li>
</ol>
<h3 id="quantitative-vs-quantitative">Quantitative VS Quantitative</h3>
<p>A <strong>scatter plot</strong> is one of the most commonly used tools to visualize the relationship between two quantitative variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">plot</span>(iris<span class="sc">$</span>Sepal.Length,iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-20-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>It can give an idea of the relationship between the 2 variables.</p>
<h3 id="quantitative-vs-qualitative">Quantitative VS Qualitative</h3>
<p>The command <code>by</code> gives statistics summary for each modality of the qualitative variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="fu">by</span>(iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">INDICES=</span>iris[,<span class="st">"Species"</span>], <span class="at">FUN=</span>summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>iris[, "Species"]: setosa
  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.300   Min.   :1.000   Min.   :0.100  
 1st Qu.:4.800   1st Qu.:3.200   1st Qu.:1.400   1st Qu.:0.200  
 Median :5.000   Median :3.400   Median :1.500   Median :0.200  
 Mean   :5.006   Mean   :3.428   Mean   :1.462   Mean   :0.246  
 3rd Qu.:5.200   3rd Qu.:3.675   3rd Qu.:1.575   3rd Qu.:0.300  
 Max.   :5.800   Max.   :4.400   Max.   :1.900   Max.   :0.600  
------------------------------------------------------------ 
iris[, "Species"]: versicolor
  Sepal.Length    Sepal.Width     Petal.Length   Petal.Width   
 Min.   :4.900   Min.   :2.000   Min.   :3.00   Min.   :1.000  
 1st Qu.:5.600   1st Qu.:2.525   1st Qu.:4.00   1st Qu.:1.200  
 Median :5.900   Median :2.800   Median :4.35   Median :1.300  
 Mean   :5.936   Mean   :2.770   Mean   :4.26   Mean   :1.326  
 3rd Qu.:6.300   3rd Qu.:3.000   3rd Qu.:4.60   3rd Qu.:1.500  
 Max.   :7.000   Max.   :3.400   Max.   :5.10   Max.   :1.800  
------------------------------------------------------------ 
iris[, "Species"]: virginica
  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.900   Min.   :2.200   Min.   :4.500   Min.   :1.400  
 1st Qu.:6.225   1st Qu.:2.800   1st Qu.:5.100   1st Qu.:1.800  
 Median :6.500   Median :3.000   Median :5.550   Median :2.000  
 Mean   :6.588   Mean   :2.974   Mean   :5.552   Mean   :2.026  
 3rd Qu.:6.900   3rd Qu.:3.175   3rd Qu.:5.875   3rd Qu.:2.300  
 Max.   :7.900   Max.   :3.800   Max.   :6.900   Max.   :2.500  </code></pre>
</div>
</div>
<p>The <code>psych</code> package, using <code>describe</code>, allows to compute the following statistics :</p>
<ul>
<li><p>Number of observations</p></li>
<li><p>Mean</p></li>
<li><p>Standard deviation<br>
</p></li>
<li><p>Median</p></li>
<li><p>Trimmed mean (calculated by removing the 5 smallest and 5 largest values)</p></li>
<li><p>Median absolute deviation (robust measure of spread, defined as the median of the absolute differences between each value and the dataset’s median)</p></li>
<li><p>Minimum<br>
</p></li>
<li><p>Maximum<br>
</p></li>
<li><p>Range (maximum − minimum)</p></li>
<li><p>Skewness (measures the asymmetry of a distribution, indicating whether the data are skewed to the left (negative) or right (positive) )</p></li>
<li><p>Kurtosis (measures the “tailedness” of a distribution, indicating whether data have heavy tails (outliers) or light tails compared to a normal distribution)</p></li>
<li><p>Standard error (measures how much a sample mean is likely to vary from the true population mean)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="fu">library</span>(psych)</span>
<span id="cb39-2"><a href=""></a><span class="fu">describeBy</span>(iris, <span class="at">group=</span>iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
group: setosa
             vars  n mean   sd median trimmed  mad min max range skew kurtosis
Sepal.Length    1 50 5.01 0.35    5.0    5.00 0.30 4.3 5.8   1.5 0.11    -0.45
Sepal.Width     2 50 3.43 0.38    3.4    3.42 0.37 2.3 4.4   2.1 0.04     0.60
Petal.Length    3 50 1.46 0.17    1.5    1.46 0.15 1.0 1.9   0.9 0.10     0.65
Petal.Width     4 50 0.25 0.11    0.2    0.24 0.00 0.1 0.6   0.5 1.18     1.26
Species         5 50 1.00 0.00    1.0    1.00 0.00 1.0 1.0   0.0  NaN      NaN
               se
Sepal.Length 0.05
Sepal.Width  0.05
Petal.Length 0.02
Petal.Width  0.01
Species      0.00
------------------------------------------------------------ 
group: versicolor
             vars  n mean   sd median trimmed  mad min max range  skew kurtosis
Sepal.Length    1 50 5.94 0.52   5.90    5.94 0.52 4.9 7.0   2.1  0.10    -0.69
Sepal.Width     2 50 2.77 0.31   2.80    2.78 0.30 2.0 3.4   1.4 -0.34    -0.55
Petal.Length    3 50 4.26 0.47   4.35    4.29 0.52 3.0 5.1   2.1 -0.57    -0.19
Petal.Width     4 50 1.33 0.20   1.30    1.32 0.22 1.0 1.8   0.8 -0.03    -0.59
Species         5 50 2.00 0.00   2.00    2.00 0.00 2.0 2.0   0.0   NaN      NaN
               se
Sepal.Length 0.07
Sepal.Width  0.04
Petal.Length 0.07
Petal.Width  0.03
Species      0.00
------------------------------------------------------------ 
group: virginica
             vars  n mean   sd median trimmed  mad min max range  skew kurtosis
Sepal.Length    1 50 6.59 0.64   6.50    6.57 0.59 4.9 7.9   3.0  0.11    -0.20
Sepal.Width     2 50 2.97 0.32   3.00    2.96 0.30 2.2 3.8   1.6  0.34     0.38
Petal.Length    3 50 5.55 0.55   5.55    5.51 0.67 4.5 6.9   2.4  0.52    -0.37
Petal.Width     4 50 2.03 0.27   2.00    2.03 0.30 1.4 2.5   1.1 -0.12    -0.75
Species         5 50 3.00 0.00   3.00    3.00 0.00 3.0 3.0   0.0   NaN      NaN
               se
Sepal.Length 0.09
Sepal.Width  0.05
Petal.Length 0.08
Petal.Width  0.04
Species      0.00</code></pre>
</div>
</div>
<p>For each quantitative variable, possible to plot the boxplot for all the modalities of the qualitative variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species,</span>
<span id="cb41-2"><a href=""></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"yellow"</span>),</span>
<span id="cb41-3"><a href=""></a>        <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Boxplot pour la variable Sepal.Length, par espèce d'iris"</span>),</span>
<span id="cb41-4"><a href=""></a>        <span class="at">ylab =</span> <span class="st">"Quantiles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="qualitative-vs-qualitative">Qualitative VS Qualitative</h3>
<p>First we create another qualitative variable for our example : <code>Sepal.Length_cat</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a>iris<span class="sc">$</span>Sepal.Length_cat[iris<span class="sc">$</span>Sepal.Length<span class="sc">&lt;=</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="st">"petit"</span></span>
<span id="cb42-2"><a href=""></a>iris<span class="sc">$</span>Sepal.Length_cat[iris<span class="sc">$</span>Sepal.Length<span class="sc">&lt;=</span><span class="dv">6</span> <span class="sc">&amp;</span> iris<span class="sc">$</span>Sepal.Length<span class="sc">&gt;</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="st">"moyen"</span></span>
<span id="cb42-3"><a href=""></a>iris<span class="sc">$</span>Sepal.Length_cat[iris<span class="sc">$</span>Sepal.Length<span class="sc">&gt;</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="st">"grand"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal.Length_cat
1          5.1         3.5          1.4         0.2  setosa            moyen
2          4.9         3.0          1.4         0.2  setosa            petit
3          4.7         3.2          1.3         0.2  setosa            petit
4          4.6         3.1          1.5         0.2  setosa            petit
5          5.0         3.6          1.4         0.2  setosa            petit
6          5.4         3.9          1.7         0.4  setosa            moyen</code></pre>
</div>
</div>
<p>We get contingency table with <code>table</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a>table_Species_Length<span class="ot">&lt;-</span><span class="fu">table</span>(iris<span class="sc">$</span>Species,iris<span class="sc">$</span>Sepal.Length_cat)</span>
<span id="cb45-2"><a href=""></a>table_Species_Length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
             grand moyen petit
  setosa         0    22    28
  versicolor    20    27     3
  virginica     41     8     1</code></pre>
</div>
</div>
<p>the sum for each modality of <code>Species</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a><span class="fu">margin.table</span>(table_Species_Length, <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    setosa versicolor  virginica 
        50         50         50 </code></pre>
</div>
</div>
<p>the sum for each modality of <code>Sepal.Length_cat</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="fu">margin.table</span>(table_Species_Length, <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
grand moyen petit 
   61    57    32 </code></pre>
</div>
</div>
<p>the same with proportions (with respect to the total number of observations)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="fu">prop.table</span>(table_Species_Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
                   grand       moyen       petit
  setosa     0.000000000 0.146666667 0.186666667
  versicolor 0.133333333 0.180000000 0.020000000
  virginica  0.273333333 0.053333333 0.006666667</code></pre>
</div>
</div>
<p>now with respect to the number of observations for each row</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a><span class="fu">prop.table</span>(table_Species_Length, <span class="dv">1</span>) <span class="co"># proportion sur l'effectif total de la ligne</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
             grand moyen petit
  setosa      0.00  0.44  0.56
  versicolor  0.40  0.54  0.06
  virginica   0.82  0.16  0.02</code></pre>
</div>
</div>
<p>and finally with respect to the number of each column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href=""></a><span class="fu">prop.table</span>(table_Species_Length, <span class="dv">2</span>) <span class="co"># proportion sur l'effectif total de la colonne</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
                 grand     moyen     petit
  setosa     0.0000000 0.3859649 0.8750000
  versicolor 0.3278689 0.4736842 0.0937500
  virginica  0.6721311 0.1403509 0.0312500</code></pre>
</div>
</div>
<p>The gmodels package allows to create more advanced tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href=""></a><span class="fu">library</span>(gmodels)</span>
<span id="cb57-2"><a href=""></a><span class="fu">CrossTable</span>(iris<span class="sc">$</span>Species,iris<span class="sc">$</span>Sepal.Length_cat,<span class="at">prop.chisq=</span><span class="cn">FALSE</span>,<span class="at">chisq=</span><span class="cn">FALSE</span>,<span class="at">expected=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  150 

 
             | iris$Sepal.Length_cat 
iris$Species |     grand |     moyen |     petit | Row Total | 
-------------|-----------|-----------|-----------|-----------|
      setosa |         0 |        22 |        28 |        50 | 
             |     0.000 |     0.440 |     0.560 |     0.333 | 
             |     0.000 |     0.386 |     0.875 |           | 
             |     0.000 |     0.147 |     0.187 |           | 
-------------|-----------|-----------|-----------|-----------|
  versicolor |        20 |        27 |         3 |        50 | 
             |     0.400 |     0.540 |     0.060 |     0.333 | 
             |     0.328 |     0.474 |     0.094 |           | 
             |     0.133 |     0.180 |     0.020 |           | 
-------------|-----------|-----------|-----------|-----------|
   virginica |        41 |         8 |         1 |        50 | 
             |     0.820 |     0.160 |     0.020 |     0.333 | 
             |     0.672 |     0.140 |     0.031 |           | 
             |     0.273 |     0.053 |     0.007 |           | 
-------------|-----------|-----------|-----------|-----------|
Column Total |        61 |        57 |        32 |       150 | 
             |     0.407 |     0.380 |     0.213 |           | 
-------------|-----------|-----------|-----------|-----------|

 </code></pre>
</div>
</div>
</section></section>
<section>
<section id="probability-and-sampling" class="title-slide slide level1 center">
<h1>Probability and sampling</h1>
<p>coming !</p>
</section>
<section id="probability" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Probability</h2>
<p>coming !</p>
</section>
<section id="sampling" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Sampling</h2>
<p>coming !</p>
</section></section>
<section>
<section id="statistical-tests" class="title-slide slide level1 center">
<h1>Statistical tests</h1>
<p><br></p>
<ul>
<li>Tools to decide if data supports an hypothesis<br>
</li>
<li>Compare observed results with what is expected under an hypothesis</li>
<li>Help control errors</li>
<li>Guide data-driven decisions</li>
</ul>
</section>
<section id="statistical-hypothesis-tests" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Statistical hypothesis tests</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>A <strong>procedure</strong> to know if <strong>something has changed</strong> in a poputalion.</p>
<p><br></p>
<ul>
<li>Collect a <strong>sample</strong> that is representative of the whole population.<br>
</li>
<li>State the <strong>hypothesis</strong> you want to test.</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<p><em>A very good video about statistical hypothesis testing.</em></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/vVDahuv1bq8?si=mIvzP_JWAZEmAc3e" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<h3 id="the-hypothesis">The Hypothesis</h3>
<p>Two Competing Hypotheses :</p>
<ol type="1">
<li><p><strong>Null hypothesis</strong> H0 :<br>
The conservative hypothesis ; “There is nothing going on !”</p></li>
<li><p><strong>Alternative hypothesis</strong> H1 :<br>
“There is something going on”</p></li>
</ol>
<p><br></p>
<h3 id="type-1-and-type-2-errors">Type 1 and Type 2 Errors</h3>
<p>In a hypothesis test, we make a decision about which of H0 or H1 might be true, but <strong>our decision might be incorrect</strong> !</p>
<table class="caption-top">
<colgroup>
<col style="width: 36%">
<col style="width: 33%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">We fail to reject <span class="math inline">\(H_0\)</span></th>
<th style="text-align: center;">We reject <span class="math inline">\(H_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">In reality <span class="math inline">\(H_0\)</span> is true</td>
<td style="text-align: center;"><span class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;">Type 1 Error <span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">In reality <span class="math inline">\(H_1\)</span> is true</td>
<td style="text-align: center;">Type 2 Error <span class="math inline">\(\beta\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\checkmark\)</span></td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li><strong>Goal</strong> : Minimizing Type I error (<span class="math inline">\(\alpha\)</span>) and Type II error <span class="math inline">\((\beta)\)</span><br>
</li>
<li>Many ways to minimize a problem with 2 parameters.</li>
</ul>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Type I error &gt; Type II error</strong></p>
</div>
<div class="callout-content">
<p>Type I error (<span class="math inline">\(\alpha\)</span>) and Type II error <span class="math inline">\((\beta)\)</span> <strong>DO NOT HAVE THE SAME IMPACT</strong> on the situation being tested !!<br>
Type I error (<span class="math inline">\(\alpha\)</span>) is way more harmful !</p>
<p><strong>Therefore we fix <span class="math inline">\(\alpha\)</span> as small as we like, and try to minimize <span class="math inline">\(\beta\)</span>.</strong></p>
</div>
</div>
</div>
<p><br></p>
<h3 id="inside-a-statistical-hypothesis-test">“Inside” a statistical hypothesis test</h3>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The next step of hypothesis testing is to <strong>weigh the evidence</strong> !</p>
<p>Could these data plausibly have happened <strong>by chance</strong> if the H0 was true ?</p>
</div>
</div>
</div>
<p><br></p>
<p><strong>The procedure</strong> :</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>We collect data in our population</p></li>
<li><p>We import our data in RStudio</p></li>
<li><p>We use the right test</p></li>
<li><p>We “write” the test we chose</p></li>
<li><p>And according to the <strong>p-value</strong> we get, we can accept or reject H0</p>
<ul>
<li>If <strong>p-value</strong> &gt; <span class="math inline">\(\alpha\)</span>, then we accept H0</li>
<li>If <strong>p-value</strong> &lt; <span class="math inline">\(\alpha\)</span>, then we reject H0</li>
</ul></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:30%;">
<iframe width="315" height="560" src="https://www.youtube.com/embed/plj34_wNxLc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media;
gyroscope; picture-in-picture;
web-share" allowfullscreen="">
</iframe>
</div></div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What remains to be learned?</strong></p>
</div>
<div class="callout-content">
<p>We now need to learn which test to choose, how to choose it, and how to implement it on RStudio.<br>
cf.&nbsp;next slides</p>
</div>
</div>
</div>
<p><br></p>
<h3 id="example">Example</h3>
<div class="columns">
<div class="column" style="width:55%;">
<p>A first example of hypothesis testing within <strong>R</strong>.</p>
<p>In this video, the author tackle two questions relating to R’s built-in <code>airquality data set</code>. We’ll view this set as a simple random sample of air quality measurements in New York City.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:35%;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/oNpfjcIf2Es?si=GqN20QketJmQFy8I" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Questions</strong></p>
</div>
<div class="callout-content">
<ul>
<li>An official claims that the average wind speed in the city is 9 miles per hour. Is this plausible ?<br>
</li>
<li>A certain solar array will only be cost-effective if mean solar radiation is over 175 Langleys. Would it be a sound investment in light of this data?</li>
</ul>
</div>
</div>
</div>
<p><br></p>
<p>Let’s go work on <strong>RStudio</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-2"><a href=""></a><span class="fu">head</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Ozone Solar.R Wind Temp Month Day
1    41     190  7.4   67     5   1
2    36     118  8.0   72     5   2
3    12     149 12.6   74     5   3
4    18     313 11.5   62     5   4
5    NA      NA 14.3   56     5   5
6    28      NA 14.9   66     5   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a><span class="fu">dim</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 153   6</code></pre>
</div>
</div>
<p>The dataset used here is called <code>airquality</code>. There are 6 variables and 153 individuals.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><code>Ozone</code><br>
</li>
<li><code>Solar.R</code><br>
</li>
<li><code>Wind</code></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><code>Temp</code></li>
<li><code>Month</code><br>
</li>
<li><code>Day</code></li>
</ul>
</div></div>
<h4 id="question-1">Question 1</h4>
<p>In order to answer the first question, we look at <code>Wind</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href=""></a><span class="fu">qplot</span>(airquality<span class="sc">$</span>Wind, <span class="at">geom =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-34-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : the null hypotesis</strong></p>
</div>
<div class="callout-content">
<p>Here the null hypotesis is that the average wind speed in the city is 9 miles per hour.</p>
</div>
</div>
</div>
<p>We will use here a <code>t.test</code>. We explain more about this test in next slides.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a><span class="fu">t.test</span>(airquality<span class="sc">$</span>Wind, <span class="at">mu =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  airquality$Wind
t = 3.3619, df = 152, p-value = 0.0009794
alternative hypothesis: true mean is not equal to 9
95 percent confidence interval:
  9.394804 10.520229
sample estimates:
mean of x 
 9.957516 </code></pre>
</div>
</div>
<p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.0010 \ \simeq \ 0.1 \% \ &lt; \alpha = 5 \%\)</span></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Conclusion</strong></p>
</div>
<div class="callout-content">
<p>We can therefore reject H0.</p>
<p>The average wind speed in the city is NOT 9 miles per hour.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="question-2">Question 2</h4>
<p>In order to answer the second question, we look at <code>Solar.R</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href=""></a><span class="fu">qplot</span>(airquality<span class="sc">$</span>Solar.R, <span class="at">geom =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-36-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : the null hypotesis</strong></p>
</div>
<div class="callout-content">
<p>Here the null hypotesis is that the mean solar radiation is 175 Langleys.<br>
And the alternative hypothesis H1 is that this mean is greater than 175 Langleys.</p>
</div>
</div>
</div>
<p>Again we will use here a <code>t.test</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href=""></a><span class="fu">t.test</span>(airquality<span class="sc">$</span>Solar.R, <span class="at">mu =</span> <span class="dv">175</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  airquality$Solar.R
t = 1.4667, df = 145, p-value = 0.07232
alternative hypothesis: true mean is greater than 175
95 percent confidence interval:
 173.5931      Inf
sample estimates:
mean of x 
 185.9315 </code></pre>
</div>
</div>
<p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.072 \ \simeq \ 7.2 \% \ &gt; \alpha = 5 \%\)</span></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Conclusion</strong></p>
</div>
<div class="callout-content">
<p>We can therefore accept H0.</p>
</div>
</div>
</div>
</section>
<section id="parametric-and-nonparametric-statistical-tests" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Parametric and nonparametric statistical tests</h2>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p><strong>Parametric tests</strong> : requirements about the <strong>shape</strong> of the populations involved</p></li>
<li><p><strong>Non-parametric tests</strong> do not require that samples come from populations with normal distributions or have any other particular distributions.</p></li>
</ul>
<p>Non-parametric tests are called distribution-free tests.</p>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<p><em>An interesting on the difference between parametric and non-parametric test.</em></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/welIUs2boQ8?si=qUHcIB0N6EuLE5IR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<p><br></p>
<h3 id="parametric-tests-non-parametric-tests">Parametric tests &lt; Non-parametric tests</h3>
<ul>
<li><p>Nonparametric methods can be <strong>applied to a wide variety of situations</strong> because they do not have the more rigid requirements of the corresponding parametric methods.</p></li>
<li><p>Unlike parametric methods, nonparametric methods can <strong>often be applied to categorical data</strong>.</p></li>
<li><p>Nonparametric methods usually involve <strong>simpler computations</strong> than the corresponding parametric methods.</p></li>
</ul>
<p><br></p>
<h3 id="parametric-tests-non-parametric-tests-1">Parametric tests &gt; Non-parametric tests</h3>
<ul>
<li><p>Nonparametric methods tend to <strong>waste information</strong></p></li>
<li><p>Nonparametric tests are <strong>not as efficient</strong> as parametric tests</p></li>
<li><p>With a nonparametric test we need <strong>stronger evidence</strong> (such as a larger sample or greater differences) before we reject a null hypothesis.</p></li>
</ul>
</section>
<section id="chi-squared-tests" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Chi-squared tests</h2>
<ul>
<li><p>There are three types of Chi-squared tests.</p></li>
<li><p>We write Chi-squared OR <span class="math inline">\(\chi^2\)</span>.</p></li>
</ul>
<p><br></p>
<h3 id="chi2-goodness-of-fit-test"><img data-src="img/logo-stat.png" style="width:3.0%"> <span class="math inline">\(\chi^2\)</span> goodness-of-fit test</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">/</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Qualitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>Observations must be independent</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The population follows the specified distribution.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-1">Example :</h4>
<div class="columns">
<div class="column" style="width:45%;">
<p>The author tackle two goodness-of-fit problems using <strong>R</strong>.</p>
<ul>
<li>One with different proportions<br>
</li>
<li>One with same proportions</li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/n5c11B5FJ24?si=hpfaWjXHjBlrp1OP" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<p><br></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>1st problem</strong></p>
</div>
<div class="callout-content">
<ul>
<li>A college reports that
<ul>
<li><span class="math inline">\(50 \%\)</span> of the students in its statistics classes are freshmen,</li>
<li><span class="math inline">\(30 \%\)</span> are sophomores,</li>
<li><span class="math inline">\(10 \%\)</span> are juniors,</li>
<li>and <span class="math inline">\(10 \%\)</span> are seniors.</li>
</ul></li>
</ul>
<p>A simple random sample of <span class="math inline">\(65\)</span> such students has the following breakdown :</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Freshman</th>
<th style="text-align: center;">Sophomore</th>
<th style="text-align: center;">Junior</th>
<th style="text-align: center;">Senior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">28</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>Does this constitute sufficient evidence to doubt the percentages reported by the college ?</p>
</div>
</div>
</div>
<p>We define the variable <code>years</code> sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href=""></a>years <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">24</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>then the proportions expected from what the college did report</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href=""></a>props <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Now we can perform our goodness-of-fit test.</p></li>
<li><p>Here the null hypothesis is that the population follows the specified distribution, meaning the sample does agree with what the college did report.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href=""></a><span class="fu">chisq.test</span>(years, <span class="at">p =</span> props)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  years
X-squared = 3.5846, df = 3, p-value = 0.31</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.31 \ \simeq \ 31 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The sample made do not constitute sufficient evidence to doubt the percentages reported by the college <br></p></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>2nd problem</strong></p>
</div>
<div class="callout-content">
<ul>
<li>200 rolls of a die result in the following distribution:</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">28</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">51</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>Should we conclude that the die is unfair ?</p>
</div>
</div>
</div>
<p>We define the variable <code>years</code> for the sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href=""></a>counts <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">22</span>, <span class="dv">31</span>, <span class="dv">38</span>, <span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Given the theoretical proportion will be all the same, we do not need to define a vector for the proportions.</p></li>
<li><p>Here H0 is that the die is fair.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href=""></a><span class="fu">chisq.test</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  counts
X-squared = 15.22, df = 5, p-value = 0.009463</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.001 \ \simeq \ 0.01 \% \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>According to this test we are going to say that the die is unfair.</p></li>
</ul>
<p><br></p>
<h3 id="chi2-test-for-homogeneity"><img data-src="img/logo-stat.png" style="width:3.0%"> <span class="math inline">\(\chi^2\)</span> test for homogeneity</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">Qualitative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Qualitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>Each population is at least 10 times as large as its respective sample</li>
<li>The expected frequency count for each value is at least 5</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The distribution of the categorical variable is the same for each subgroup or population</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-2">Example :</h4>
<div class="columns">
<div class="column" style="width:55%;">
<p>The author tackle one <span class="math inline">\(\chi^2\)</span> test for homogeneity using <strong>R</strong>.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Problem</strong></p>
</div>
<div class="callout-content">
<p>A random sample of students at two universities resulted in the following distribution of fields of study:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">University</th>
<th style="text-align: left;">Business</th>
<th style="text-align: left;">Engineering</th>
<th style="text-align: left;">Liberal arts</th>
<th style="text-align: left;">Nursing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: left;">64</td>
<td style="text-align: left;">47</td>
<td style="text-align: left;">145</td>
<td style="text-align: left;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: left;">41</td>
<td style="text-align: left;">35</td>
<td style="text-align: left;">174</td>
<td style="text-align: left;">52</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:35%;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/eQ9hHDDJj0M?si=ASL8lBrZX5hPVUqM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<p><br></p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>Is it safe to conclude that the populations of students in the two schools have different distributions of fields of study?</p>
</div>
</div>
</div>
<ul>
<li><p>We define the vector <code>students</code>.</p></li>
<li><p>From <code>students</code> we define the matrix <code>m</code></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href=""></a>students <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">64</span>, <span class="dv">47</span>, <span class="dv">145</span>, <span class="dv">31</span>, <span class="dv">41</span>, <span class="dv">35</span>, <span class="dv">174</span>, <span class="dv">52</span>)</span>
<span id="cb76-2"><a href=""></a>m <span class="ot">=</span> <span class="fu">matrix</span>(students, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-3"><a href=""></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]   64   47  145   31
[2,]   41   35  174   52</code></pre>
</div>
</div>
<p>It’s optionnal, but can name the columns and rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href=""></a><span class="fu">colnames</span>(m) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Business"</span>, <span class="st">"Engineering"</span>, <span class="st">"Liberal arts"</span>, <span class="st">"Nursing"</span>)</span>
<span id="cb78-2"><a href=""></a><span class="fu">rownames</span>(m) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>)</span>
<span id="cb78-3"><a href=""></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Business Engineering Liberal arts Nursing
A       64          47          145      31
B       41          35          174      52</code></pre>
</div>
</div>
<ul>
<li><p>Now we can perform our <span class="math inline">\(\chi^2\)</span> test for homogenity.</p></li>
<li><p>Here the null hypothesis H0 is that the populations of students in the two schools have the same distribution of fields of study.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href=""></a><span class="fu">chisq.test</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  m
X-squared = 14.371, df = 3, p-value = 0.002441</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.002 \ \simeq \ 0.2 \% \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The populations of students in the two schools have different distributions of fields of study.</p></li>
</ul>
<p><br></p>
<h3 id="chi2-test-for-independence"><img data-src="img/logo-stat.png" style="width:3.0%"> <span class="math inline">\(\chi^2\)</span> test for independence</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">Qualitative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Qualitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li>Observations must be independent</li>
<li>Relatively large sample size</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>There is no association between the two variables.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-3">Example :</h4>
<div class="columns">
<div class="column" style="width:45%;">
<p>The author tackle a <span class="math inline">\(\chi^2\)</span> test for independence using <strong>R</strong>.</p>
<p>The two variables are :</p>
<ul>
<li><p>the type of volunteer</p></li>
<li><p>the amount of hours spend voluntering</p></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/XfsDtYuwVzs?si=qphE7yoKYG1pVMjz" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<p><br></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Problem</strong></p>
</div>
<div class="callout-content">
<p>In a volunteer group, adults 21 and older volunteer from one to nine hours each week to spend time with a disabled senior citizen. The program recruits among :<br>
- community college students,</p>
<ul>
<li><p>four-year college students,</p></li>
<li><p>and nonstudents.</p></li>
</ul>
<p>In the table we have a sample of the adult volunteers and the number of hours they volunteer per week.</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Type of Volunteer</th>
<th style="text-align: left;">1-3 Hours</th>
<th style="text-align: left;">4-6 Hours</th>
<th style="text-align: left;">7-9 Hours</th>
<th style="text-align: left;">Row Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Community College Students</td>
<td style="text-align: left;">111</td>
<td style="text-align: left;">96</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">255</td>
</tr>
<tr class="even">
<td style="text-align: left;">Four-Year College Students</td>
<td style="text-align: left;">96</td>
<td style="text-align: left;">133</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">290</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nonstudents</td>
<td style="text-align: left;">91</td>
<td style="text-align: left;">150</td>
<td style="text-align: left;">53</td>
<td style="text-align: left;">294</td>
</tr>
<tr class="even">
<td style="text-align: left;">Column Total</td>
<td style="text-align: left;">298</td>
<td style="text-align: left;">379</td>
<td style="text-align: left;">162</td>
<td style="text-align: left;">839</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>Is the number of hours volunteered independent of the type of volunteer?</p>
</div>
</div>
</div>
<p>We define the variable <code>volunteers</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href=""></a>volunteers <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">111</span>, <span class="dv">96</span>, <span class="dv">48</span>, <span class="dv">96</span>, <span class="dv">133</span>, <span class="dv">61</span>, <span class="dv">91</span>, <span class="dv">150</span>, <span class="dv">53</span>), <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb82-2"><a href=""></a>volunteers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  111   96   48
[2,]   96  133   61
[3,]   91  150   53</code></pre>
</div>
</div>
<p>We name the columns and the rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href=""></a><span class="fu">rownames</span>(volunteers) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Community College"</span>, <span class="st">"Four Year"</span>, <span class="st">"Nonstudent"</span>)</span>
<span id="cb84-2"><a href=""></a><span class="fu">colnames</span>(volunteers) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1-3 hours"</span>, <span class="st">"4-6 hours"</span>, <span class="st">"7-9 hours"</span>)</span>
<span id="cb84-3"><a href=""></a>volunteers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  1-3 hours 4-6 hours 7-9 hours
Community College       111        96        48
Four Year                96       133        61
Nonstudent               91       150        53</code></pre>
</div>
</div>
<ul>
<li><p>Now we can perform our <span class="math inline">\(\chi^2\)</span> indendence test.</p></li>
<li><p>Here the null hypothesis is that the two variables are independent.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href=""></a>model <span class="ot">=</span> <span class="fu">chisq.test</span>(volunteers)</span>
<span id="cb86-2"><a href=""></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  volunteers
X-squared = 12.991, df = 4, p-value = 0.01132</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.01 \ \simeq \ 1 \% \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>It does look like, according to this sample, that the number of hours volunteered is dependent of the type of volunteer.</p></li>
</ul>
<p><br></p>
</section>
<section id="binomial-test" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Binomial test</h2>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Qualitative (Binary)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li>Random samples</li>
<li>Independent observations</li>
<li>The variable of interest is binary (only two possible outcomes)</li>
<li>The number of trials is fixed</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The population proportion of one outcome equals some claimed value.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-4">Example :</h4>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>The author tackle a binomial test to see if the proportion of leopards with a solid black coat color equals <span class="math inline">\(0.35\)</span>.</p></li>
<li><p>We are going to do it using <strong>R</strong>.</p></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/iAnwcsOSBXs?si=TxIsL1SDwwfLZxkb" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<p><br></p>
<div class="columns">
<div class="column" style="width:80%;">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Problem</strong></p>
</div>
<div class="callout-content">
<p>According to a genetic model, <span class="math inline">\(35 \%\)</span> of a certain subspecies of leopards have a solid black coat color.</p>
<ul>
<li><p>We believe this rate is lower for leopards living in a wildlife refuge.</p></li>
<li><p>So we randomly select 9 unrelated leopards and find that only 1 has a solid black coat.</p></li>
</ul>
</div>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img data-src="img/black_leopard.png" style="width:52.0%"></p>
</div></div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>Is there enough evidence to suggest that the rate is lower than <span class="math inline">\(35\%\)</span> for leopards living in the refuge.</p>
</div>
</div>
</div>
<p>We define the variables</p>
<ul>
<li><p><code>leopards_sample</code></p></li>
<li><p><code>leopards_black_coat</code></p></li>
<li><p><code>model_proportion</code></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href=""></a>leopards_sample <span class="ot">=</span> <span class="dv">9</span></span>
<span id="cb88-2"><a href=""></a>leopards_black_coat <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb88-3"><a href=""></a>model_proportion <span class="ot">=</span> <span class="fl">0.35</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Now we can perform our binomial test</p></li>
<li><p>Here the null hypothesis H0 is that the rate is equal to <span class="math inline">\(45 \%\)</span></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href=""></a><span class="fu">binom.test</span>(leopards_black_coat, leopards_sample, <span class="at">p =</span> model_proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  leopards_black_coat and leopards_sample
number of successes = 1, number of trials = 9, p-value = 0.1747
alternative hypothesis: true probability of success is not equal to 0.35
95 percent confidence interval:
 0.002809137 0.482496515
sample estimates:
probability of success 
             0.1111111 </code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.17 \ \simeq \ 17 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The rate of <span class="math inline">\(35 \%\)</span> given by the genetic model seems to be correct</p></li>
</ul>
<p><br></p>
</section>
<section id="tests-for-normality" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Tests for normality</h2>
<p>To check for normality, :</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Graphical methods
<ul>
<li>Histogram</li>
<li>Boxplot</li>
<li>Density plot</li>
<li>QQ plot</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Statistical tests
<ul>
<li>Shapiro-Wilk test</li>
<li>Kolmogorov-Smirnov test</li>
</ul></li>
</ul>
</div></div>
<p><br></p>
<h3 id="graphical-method"><img data-src="img/logo-stat.png" style="width:3.0%"> Graphical method</h3>
<p>First we load the required packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href=""></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb91-2"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb91-3"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb91-4"><a href=""></a><span class="fu">library</span>(palmerpenguins) <span class="co"># the dataset we are going to use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Histogram, density plot</strong></p>
</div>
<div class="callout-content">
<p>It gives an idea on the chance for the variable to be normal.</p>
</div>
</div>
</div>
<p>We can plot at the same time :</p>
<ul>
<li>the histogram</li>
<li>the density plot</li>
<li>the theoretical normal distribution density</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href=""></a>penguins.mean <span class="ot">=</span> <span class="fu">mean</span>(penguins<span class="sc">$</span>body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-2"><a href=""></a>penguins.sd <span class="ot">=</span> <span class="fu">sd</span>(penguins<span class="sc">$</span>body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-3"><a href=""></a></span>
<span id="cb92-4"><a href=""></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb92-5"><a href=""></a>  <span class="co"># Colors for the two curves</span></span>
<span id="cb92-6"><a href=""></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Legend"</span>,</span>
<span id="cb92-7"><a href=""></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Density plot"</span> <span class="ot">=</span> <span class="st">"#3AC275"</span>,</span>
<span id="cb92-8"><a href=""></a>                                <span class="st">"Theoretical normal distribution"</span> <span class="ot">=</span> <span class="st">"#FF59A9"</span>)) <span class="sc">+</span></span>
<span id="cb92-9"><a href=""></a>  <span class="co"># Theretical curve</span></span>
<span id="cb92-10"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"function"</span>,</span>
<span id="cb92-11"><a href=""></a>            <span class="at">fun =</span> dnorm, <span class="co">#normal distribution density function</span></span>
<span id="cb92-12"><a href=""></a>            <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> penguins.mean, <span class="at">sd =</span> penguins.sd),</span>
<span id="cb92-13"><a href=""></a>            <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Theoretical normal distribution"</span>),</span>
<span id="cb92-14"><a href=""></a>            <span class="at">linewidth =</span> <span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb92-15"><a href=""></a>  <span class="co"># Histogram</span></span>
<span id="cb92-16"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="co">#plot histogram using density, not counts</span></span>
<span id="cb92-17"><a href=""></a>                <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-18"><a href=""></a>                <span class="at">bins =</span> <span class="dv">40</span>,</span>
<span id="cb92-19"><a href=""></a>                <span class="at">alpha=</span><span class="fl">0.7</span>, </span>
<span id="cb92-20"><a href=""></a>                <span class="at">fill=</span><span class="st">"#33AADE"</span>, </span>
<span id="cb92-21"><a href=""></a>                <span class="at">color=</span><span class="st">"#332F61"</span>) <span class="sc">+</span></span>
<span id="cb92-22"><a href=""></a>  <span class="co"># Density plot</span></span>
<span id="cb92-23"><a href=""></a>  <span class="fu">geom_density</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-24"><a href=""></a>               <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb92-25"><a href=""></a>               <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Density plot"</span>),</span>
<span id="cb92-26"><a href=""></a>               <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb92-27"><a href=""></a>               <span class="at">fill=</span><span class="st">"#7EA38F"</span>) <span class="sc">+</span></span>
<span id="cb92-28"><a href=""></a>  <span class="co"># Title-s</span></span>
<span id="cb92-29"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram"</span>, <span class="at">x =</span> <span class="st">"Body mass (g)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb92-30"><a href=""></a>  <span class="co"># Side legend</span></span>
<span id="cb92-31"><a href=""></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-52-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The variable <code>body_mass_g</code> does not look like it follows a normal distribution.</p>
<p><br></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Boxplot (and violin plot)</strong></p>
</div>
<div class="callout-content">
<ul>
<li><strong>Boxplot</strong> : A normal distribution is symmetric, thus <strong>if</strong> :
<ul>
<li>the median line inside the box is roughly in the center of the box,</li>
<li>and the length of the whiskers are roughly equal on both sides, <strong>then</strong> we might have a normal distribution</li>
</ul></li>
<li><strong>Violin plot</strong> :
<ul>
<li>The width at a given value represents the density (how many points are near that value).</li>
<li>Wide sections <span class="math inline">\(\to\)</span> many observations.</li>
<li>Narrow sections <span class="math inline">\(\to\)</span> few observations</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href=""></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb93-2"><a href=""></a><span class="fu">library</span>(dplyr)</span>
<span id="cb93-3"><a href=""></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb93-4"><a href=""></a></span>
<span id="cb93-5"><a href=""></a><span class="co"># Remove rows with NA in body_mass_g</span></span>
<span id="cb93-6"><a href=""></a>penguins_clean <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass_g))</span>
<span id="cb93-8"><a href=""></a></span>
<span id="cb93-9"><a href=""></a><span class="co"># Create the plot</span></span>
<span id="cb93-10"><a href=""></a><span class="fu">ggviolin</span>(penguins_clean, </span>
<span id="cb93-11"><a href=""></a>         <span class="at">y =</span> <span class="st">"body_mass_g"</span>,</span>
<span id="cb93-12"><a href=""></a>         <span class="at">fill =</span> <span class="st">"#00AFBB"</span>,</span>
<span id="cb93-13"><a href=""></a>         <span class="at">add =</span> <span class="st">"boxplot"</span>,</span>
<span id="cb93-14"><a href=""></a>         <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb93-15"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"hhhhhh"</span>,</span>
<span id="cb93-16"><a href=""></a>       <span class="at">y =</span> <span class="st">"qjmfsjd"</span>,</span>
<span id="cb93-17"><a href=""></a>       <span class="at">x =</span> <span class="st">"lhqkfjs"</span>) <span class="sc">+</span></span>
<span id="cb93-18"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-19"><a href=""></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-53-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Same conclusion the variable <code>body_mass_g</code> does not look like it follows a normal distribution.</p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>QQ plot</strong></p>
</div>
<div class="callout-content">
<ul>
<li>A Q–Q plot compares the quantiles of your data to the quantiles of a theoretical normal distribution.</li>
<li>If the data are normally distributed, the points should fall roughly on a straight diagonal line.</li>
</ul>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href=""></a><span class="co"># Remove NA values from body_mass_g</span></span>
<span id="cb94-2"><a href=""></a>body_mass <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(penguins<span class="sc">$</span>body_mass_g)</span>
<span id="cb94-3"><a href=""></a></span>
<span id="cb94-4"><a href=""></a><span class="co"># Create a QQ plot</span></span>
<span id="cb94-5"><a href=""></a><span class="fu">ggqqplot</span>(body_mass,</span>
<span id="cb94-6"><a href=""></a>         <span class="at">title =</span> <span class="st">"QQ Plot of Penguin Body Mass"</span>,</span>
<span id="cb94-7"><a href=""></a>         <span class="at">xlab =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb94-8"><a href=""></a>         <span class="at">ylab =</span> <span class="st">"Sample Quantiles"</span>,</span>
<span id="cb94-9"><a href=""></a>         <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb94-10"><a href=""></a>         <span class="at">shape =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-54-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Again the ame conclusion, the variable <code>body_mass_g</code> does not look like it follows a normal distribution.</p>
<p><br></p>
<h3 id="shapiro-wilk-test"><img data-src="img/logo-stat.png" style="width:3.0%"> Shapiro-Wilk Test</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">/</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Quantitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>The sample size is small to moderate (e.g.&nbsp;less than 2000 observations).</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The sample comes from a normal distribution.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-5">Example :</h4>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li><p>The author tackle Shapiro-Wilk Nnormality test using <strong>R</strong>.</p></li>
<li><p>The data will be created directly in <strong>R</strong> using the comand <code>set.seed</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">946322</span>) <span class="co"># generate random values</span></span>
<span id="cb95-2"><a href=""></a>x1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb95-3"><a href=""></a>x2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/ppju5_XXzWc?si=cJ4O2tlcfQi7voyG" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</div></div>
<p><br></p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>Are the two variables normally distributed ?</p>
</div>
</div>
</div>
<p>We apply a shapiro test for the two variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href=""></a><span class="fu">shapiro.test</span>(x1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  x1
W = 0.98862, p-value = 0.5548</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.55 \ \simeq \ 55 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The sample X1 does look like it is normally distributed</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href=""></a><span class="fu">shapiro.test</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  x2
W = 0.93307, p-value = 7.464e-05</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 7.5 \ 10^{-5}  \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The sample X2 does NOT look like it is normally distributed</p></li>
</ul>
<p><br></p>
<h3 id="kolmogorov-smirnov-test"><img data-src="img/logo-stat.png" style="width:3.0%"> Kolmogorov-Smirnov Test</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">/</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Quantitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>/</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The sample comes from a normal distribution.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-6">Example :</h4>
<p>We create a variable Y :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href=""></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">8.43</span>, <span class="fl">8.70</span>, <span class="fl">11.27</span>, <span class="fl">12.92</span>, <span class="fl">13.05</span>, <span class="fl">13.05</span>, <span class="fl">13.17</span>, <span class="fl">13.44</span>, <span class="fl">13.89</span>, <span class="fl">18.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>We are going to use the Kolmogorov-Smirnov test for an normal distribution.</p></li>
<li><p>It is written like this :</p></li>
</ul>
<p><code>ks.test(Y, "pnorm", mean = mean(Y), sd = sd(Y))</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href=""></a><span class="fu">ks.test</span>(Y,<span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(Y), <span class="at">sd =</span> <span class="fu">sd</span>(Y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  Y
D = 0.23999, p-value = 0.6122
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.61 \ \simeq \ 61 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The sample Y does look like it is normally distributed</p></li>
</ul>
<p><br></p>
</section>
<section id="tests-for-homogeneity-of-variances" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Tests for homogeneity of variances</h2>
<p>There are two main tests.</p>
<h3 id="levene-test"><img data-src="img/logo-stat.png" style="width:3.0%"> Levene test</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">Quantitative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Qualitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>Independent observations</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The variance among groups is equal.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-7">Example :</h4>
<p>We import the dataset <code>titanic.csv</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href=""></a>titanic.data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"data_raw/titanic.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>we load the required packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href=""></a><span class="fu">library</span>(car)</span>
<span id="cb104-2"><a href=""></a><span class="fu">library</span>(carData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>In the dataset <code>titanic</code>, do the two groups <code>dead</code>and <code>alive</code> have the same variance ?</p>
</div>
</div>
</div>
<p>we perform our levene test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href=""></a><span class="fu">leveneTest</span>(age <span class="sc">~</span> survive, <span class="at">data =</span> titanic.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value  Pr(&gt;F)  
group   1  5.1144 0.02407 *
      631                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.024 \ \simeq \ 2.4 \% \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The two groups do not have the same variance.</p></li>
</ul>
<h3 id="bartlett-test"><img data-src="img/logo-stat.png" style="width:3.0%"> Bartlett test</h3>
<p><em>Non-parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th style="text-align: center;">Quantitative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td style="text-align: center;">Qualitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>It does not assume equal sample sizes across groups</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The variance among groups is equal.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-8">Example :</h4>
<p>We use the same dataset <code>titanic</code>, but this time we change variable.</p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>In the dataset <code>titanic</code>, do the two groups <code>female</code>and <code>male</code> have the same variance ?</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href=""></a><span class="fu">bartlett.test</span>(age <span class="sc">~</span> sex, <span class="at">data =</span> titanic.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  age by sex
Bartlett's K-squared = 0.049888, df = 1, p-value = 0.8233</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.82 \ \simeq \ 8.2 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The two groups have the same variance.</p></li>
</ul>
</section>
<section id="t-tests" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> T-tests</h2>
<p>There are different T-tests.</p>
<h3 id="t-test-for-one-sample"><img data-src="img/logo-stat.png" style="width:3.0%"> T-test for one sample</h3>
<p><em>Parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Quantitative (continuous)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>-</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li><p>Normality : dependent variables should be normally distributed within each group</p></li>
<li><p>Homogenity of variance</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The sample mean is equal to the given reference value</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-9">Example :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6_3cPhD3DVw?si=blrAB-dTzA1N6ErH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<p>We collect a sample of 10 birth weight of sheep.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href=""></a>weight <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.5</span>, <span class="dv">3</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="dv">4</span>, <span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are not outliers.</p>
<p>The null hypothesis H0 is : <span class="math inline">\(\mu = 3.5\)</span>, and we chose <span class="math inline">\(\alpha = 5 \%\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href=""></a><span class="fu">t.test</span>(weight, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  weight
t = -3.6122, df = 9, p-value = 0.00564
alternative hypothesis: true mean is not equal to 3.5
95 percent confidence interval:
 1.955063 3.144937
sample estimates:
mean of x 
     2.55 </code></pre>
</div>
</div>
<p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.006 \ \simeq \ 0.6 \% \ &lt; \alpha\)</span></p>
<p>Therefore we can reject H0. The mean of the dataset if not equal to <span class="math inline">\(3.5\)</span>.</p>
<p>We can ask ourselves if the mean of the dataset is less or greater than <span class="math inline">\(3.5\)</span>.</p>
<p>The null hypothesis is just a bit different :</p>
<p>H0 : <span class="math inline">\(\mu &lt; 3.5\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href=""></a><span class="fu">t.test</span>(weight, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  weight
t = -3.6122, df = 9, p-value = 0.9972
alternative hypothesis: true mean is greater than 3.5
95 percent confidence interval:
 2.067899      Inf
sample estimates:
mean of x 
     2.55 </code></pre>
</div>
</div>
<p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.997 \ \simeq \ 99.7 \% \ &gt; \alpha\)</span></p>
<p>Therefore we can accep H0. The mean of the dataset if less than <span class="math inline">\(3.5\)</span>.</p>
<p><br></p>
<h3 id="independent-t-test"><img data-src="img/logo-stat.png" style="width:3.0%"> Independent t-test</h3>
<p><em>Parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Quantitative (continuous)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Qualitatite (2 groups)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li><p>Normality : dependent variables should be normally distributed within each group<br>
<span class="math inline">\(\to\)</span> if not met : Mann-Whitney test</p></li>
<li><p>Homogenity of variance</p></li>
<li><p>Does not assume equal sample sizes or equal variances between groups</p></li>
<li><p>Assumes independent observations drawn from normally-distributed populations</p></li>
<li><p>Robust against violations of normality when sample size is large</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The groups have equal means.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-10">Example :</h4>
<p>We load the dataset <code>bocks</code> from the library <code>GLMsData</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href=""></a><span class="fu">library</span>(GLMsData)</span>
<span id="cb114-2"><a href=""></a><span class="fu">data</span>(blocks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>we perform our t-test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href=""></a><span class="fu">t.test</span>(Number <span class="sc">~</span> Shape, <span class="at">data =</span> blocks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Number by Shape
t = 7.4956, df = 77.669, p-value = 9.056e-11
alternative hypothesis: true difference in means between group Cube and group Cylinder is not equal to 0
95 percent confidence interval:
 1.96814 3.39186
sample estimates:
    mean in group Cube mean in group Cylinder 
                  8.16                   5.48 </code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 9.05 \ 10^{-11} \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The two groups do NOT have the same mean.</p></li>
</ul>
<h3 id="paired-t-test"><img data-src="img/logo-stat.png" style="width:3.0%"> Paired t-test</h3>
<p><em>Parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Quantitative (continuous)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Time point 1 or 2 /condition</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li>Normality : dependent variables should be normally distributed within each group<br>
<span class="math inline">\(\to\)</span> if not met : Wilcoxon test</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The groups have equal means.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-11">Example :</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href=""></a><span class="co"># Weight of the mice before treatment</span></span>
<span id="cb117-2"><a href=""></a>before <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">200.1</span>, <span class="fl">190.9</span>, <span class="fl">192.7</span>, <span class="dv">213</span>, <span class="fl">241.4</span>, <span class="fl">196.9</span>, <span class="fl">172.2</span>, <span class="fl">185.5</span>, <span class="fl">205.2</span>, <span class="fl">193.7</span>)</span>
<span id="cb117-3"><a href=""></a><span class="co"># Weight of the mice after treatment</span></span>
<span id="cb117-4"><a href=""></a>after <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">392.9</span>, <span class="fl">393.2</span>, <span class="fl">345.1</span>, <span class="dv">393</span>, <span class="dv">434</span>, <span class="fl">427.9</span>, <span class="dv">422</span>, <span class="fl">383.9</span>, <span class="fl">392.3</span>, <span class="fl">352.2</span>)</span>
<span id="cb117-5"><a href=""></a><span class="co"># Create a data frame</span></span>
<span id="cb117-6"><a href=""></a>my_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( </span>
<span id="cb117-7"><a href=""></a>                <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"before"</span>, <span class="st">"after"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb117-8"><a href=""></a>                <span class="at">weight =</span> <span class="fu">c</span>(before,  after)</span>
<span id="cb117-9"><a href=""></a>                )</span>
<span id="cb117-10"><a href=""></a>my_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    group weight
1  before  200.1
2  before  190.9
3  before  192.7
4  before  213.0
5  before  241.4
6  before  196.9
7  before  172.2
8  before  185.5
9  before  205.2
10 before  193.7
11  after  392.9
12  after  393.2
13  after  345.1
14  after  393.0
15  after  434.0
16  after  427.9
17  after  422.0
18  after  383.9
19  after  392.3
20  after  352.2</code></pre>
</div>
</div>
<p>we perfrom our paired t-test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href=""></a><span class="fu">t.test</span>(before, after, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  before and after
t = -20.883, df = 9, p-value = 6.2e-09
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -215.5581 -173.4219
sample estimates:
mean difference 
        -194.49 </code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 6.2 \ 10^{-9} \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The two groups do NOT have the same mean.</p></li>
</ul>
</section>
<section id="mann-whitney-test" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Mann-Whitney test</h2>
<p><em>Non-parametric equivalent to the independent t-test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Ordinal/ Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Qualitative</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong></p>
<ul>
<li>independent samples</li>
</ul>
<p>There are two types Mann-Whitney tests. If the distribution of scores for both groups have the same shape, the medians can be compared. If not, use the default test which compares the mean ranks</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The median of the two groups are the same (if the distribution for both groups have the same shape), otherwise the mean ranks are the same.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-12">Example :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/MCD5K7oMoeg?si=ZEBe-TJXxesPrJyo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href=""></a>movieRating <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data_raw/95_Data_File.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb121-2"><a href=""></a><span class="fu">head</span>(movieRating)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Male Female
1 6.35   5.90
2 6.54   6.28
3 6.11   5.76
4 6.97   6.66
5 6.78   6.71
6 5.83   5.58</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href=""></a><span class="fu">wilcox.test</span>(movieRating<span class="sc">$</span>Male,movieRating<span class="sc">$</span>Female, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  movieRating$Male and movieRating$Female
W = 255.5, p-value = 0.1368
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.1368 \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The two groups do have the same median.</p></li>
</ul>
</section>
<section id="wilcoxon-test" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Wilcoxon test</h2>
<p><em>Non-parametric equivalent to the paired t-test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Ordinal/ Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Time/ Condition</td>
</tr>
</tbody>
</table>
<p><strong>Asumption :</strong> /</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The is no median difference between the paired observations.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-13">Example :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/SxSSbX5TY7c?si=ZaPdm68MLmWI61Iv" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href=""></a>aluLevels <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data_raw/96_Data_File.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb125-2"><a href=""></a><span class="fu">head</span>(aluLevels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Clone August November
1         Primo   12.6     12.7
2      Raspalje    9.5     10.5
3     Hazendans   16.5     15.3
4     Hoogvorst   13.6     15.6
5 Fritzi Pauley   13.3     11.1
6  Balsam Spire    8.1     11.2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href=""></a><span class="fu">wilcox.test</span>(aluLevels<span class="sc">$</span>August, aluLevels<span class="sc">$</span>November, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank exact test

data:  aluLevels$August and aluLevels$November
V = 16, p-value = 0.03979
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.039 \ = \ 0.39 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The two groups do NOT have the same median.</p></li>
</ul>
</section>
<section id="anova" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> ANOVA</h2>
<p><strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance</p>
<h3 id="one-way-anova"><img data-src="img/logo-stat.png" style="width:3.0%"> One-way ANOVA</h3>
<p><em>Parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Qualitatives (3+ groups)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li>Residuals should be normally distributed</li>
</ul>
<p><span class="math inline">\(\to\)</span> if not met : Kruskall-Wallis test</p>
<ul>
<li>Homogeneity of variance</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The population means are all equal in the groups.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-14">Example :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/GokvYQiGdm0?si=XE0qla3upiCKBzv9" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<p>We load the required packages and the dataset <code>chickwts</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb129-2"><a href=""></a><span class="fu">head</span>(chickwts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  weight      feed
1    179 horsebean
2    160 horsebean
3    136 horsebean
4    227 horsebean
5    217 horsebean
6    168 horsebean</code></pre>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p><strong>Does the feed being used help explain the weights of chicken ?</strong></p>
</div>
</div>
</div>
<p>We first look for homogeneity of variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href=""></a><span class="fu">library</span>(car)</span>
<span id="cb131-2"><a href=""></a><span class="fu">leveneTest</span>(chickwts<span class="sc">$</span>weight <span class="sc">~</span> chickwts<span class="sc">$</span>feed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  5  0.7493 0.5896
      65               </code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.59 \ = \ 59 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The groups do have the same variance</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href=""></a>model.ANOVA.OneWay <span class="ot">=</span> <span class="fu">aov</span>(chickwts<span class="sc">$</span>weight <span class="sc">~</span> chickwts<span class="sc">$</span>feed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to check if the residuals are normally distributed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href=""></a><span class="fu">shapiro.test</span>(model.ANOVA.OneWay<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  model.ANOVA.OneWay$residuals
W = 0.98616, p-value = 0.6272</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.63 \ = \ 63 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The residuals are normally distributed</p></li>
</ul>
<p>Now we can analyse the ANOVA result :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href=""></a><span class="fu">summary</span>(model.ANOVA.OneWay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
chickwts$feed  5 231129   46226   15.37 5.94e-10 ***
Residuals     65 195556    3009                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 5.94 . 10^{-10} \ &lt; \alpha\)</span></p></li>
<li><p>Therefore we can reject H0.</p></li>
<li><p>The mean are not the same all the groups.</p></li>
<li><p>The feed being used help explain the weights of chicken, but we cannot say how.</p></li>
</ul>
<p><br></p>
<h3 id="two-way-anova"><img data-src="img/logo-stat.png" style="width:3.0%"> Two-way ANOVA</h3>
<p><em>Parametric test</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independent variables</td>
<td>2 qualitative (2+ levels within each)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li><p>Residuals should be normally distributed</p></li>
<li><p>Homogeneity of variance</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>The means (by one factor) of the groups being compared are the same</p></li>
<li><p>The means (by the other factor) of the groups being compared are the same</p></li>
<li><p>There is no interaction between the two factors</p></li>
</ul>
</div>
</div>
</div>
<p><br></p>
<p>The two-way ANOVA : extension of the one-way ANOVA that examines the influence of two different categorical independent variables on one continuous dependent variable.</p>
<p>The two-way ANOVA not only aims at assessing the main effect of each independent variable but also if there is any interaction between them.</p>
<p><br></p>
<h4 id="example-15">Example :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7uR9c_yA0pE?si=9Hs_ZNtZoBhUbsII" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href=""></a><span class="fu">head</span>(ToothGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5</code></pre>
</div>
</div>
<p>We first look for homogeneity of variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href=""></a><span class="fu">library</span>(car)</span>
<span id="cb140-2"><a href=""></a><span class="fu">leveneTest</span>(len <span class="sc">~</span> supp <span class="sc">*</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> ToothGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  5  1.7086 0.1484
      54               </code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.15 \ = \ 15 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>We have the homogeneity of variance.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href=""></a>model.ANOVA.TwoWay <span class="ot">=</span> <span class="fu">aov</span>(len <span class="sc">~</span> supp <span class="sc">*</span> <span class="fu">factor</span>(dose), <span class="at">data =</span> ToothGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to check if the residuals are normally distributed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href=""></a><span class="fu">shapiro.test</span>(model.ANOVA.TwoWay<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  model.ANOVA.TwoWay$residuals
W = 0.98499, p-value = 0.6694</code></pre>
</div>
</div>
<ul>
<li><p>We get a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.67 \ = \ 67 \% \ &gt; \alpha\)</span></p></li>
<li><p>Therefore we can accept H0.</p></li>
<li><p>The residuals are normally distributed</p></li>
</ul>
<p>Now we can analyse the Two-way ANOVA result :</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
supp               1  205.4   205.4  15.572 0.000231 ***
factor(dose)       2 2426.4  1213.2  92.000  &lt; 2e-16 ***
supp:factor(dose)  2  108.3    54.2   4.107 0.021860 *  
Residuals         54  712.1    13.2                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>We get the a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.000231 \ &lt; \alpha\)</span>
<ul>
<li>Therefore we can reject the first part of the null hypothesis, which is : <span class="math inline">\(\to\)</span> The means (by the factor <code>supp</code>) of the groups are NOT the same</li>
</ul></li>
<li>We get the a <strong>p-value</strong> <span class="math inline">\(\simeq \ 2 10^{-16} \ &lt; \alpha\)</span>
<ul>
<li>Therefore we can reject the second part of the null hypothesis, which is : <span class="math inline">\(\to\)</span> The means (by the factor <code>factor(dose)</code>) of the groups are NOT the same</li>
</ul></li>
<li>We get the a <strong>p-value</strong> <span class="math inline">\(\simeq \ 0.022 \ &lt; \alpha\)</span>
<ul>
<li>Therefore we can reject the third part of the null hypothesis, which is : <span class="math inline">\(\to\)</span> There IS an interaction between the two factors</li>
</ul></li>
</ul>
</section>
<section id="post-hoc-tests" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Post hoc tests</h2>
<p>In order to find out exactly which groups are different from each other, we must conduct a <strong>post hoc test</strong>.</p>
<ul>
<li><p><strong>The Tukey test</strong> : compare all groups to each other</p></li>
<li><p><strong>The Dunnett test</strong> : compare with a reference group.</p></li>
</ul>
<h3 id="the-tukey-test"><img data-src="img/logo-stat.png" style="width:3.0%"> The Tukey test</h3>
<p><em>Often follows a one-way ANOVA</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Qualitatives (3+ groups)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li><p>the observations are independent,</p></li>
<li><p>normality of distribution,</p></li>
<li><p>homogeneity of variance.</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The means of the tested groups are equal</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-1-1">Example 1 :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/hPUvqtmCu7Q?si=qdYrpFcTmkOniI7h" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href=""></a>dietData <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data_raw/90_Data_File.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb146-2"><a href=""></a><span class="fu">head</span>(dietData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Diet Weight.Week.1 Weight.Week.8 Weight.Loss
1    1            59            55           4
2    1            61            55           6
3    1            65            64           1
4    1            65            62           3
5    1            66            63           3
6    1            67            65           2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href=""></a><span class="fu">leveneTest</span>(Weight.Loss <span class="sc">~</span> <span class="fu">factor</span>(Diet), <span class="at">data =</span> dietData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  2  2.8097 0.06657 .
      75                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>therefore we have homogeneity of variance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href=""></a>anova.tukey <span class="ot">=</span> <span class="fu">aov</span>(Weight.Loss <span class="sc">~</span> <span class="fu">factor</span>(Diet), <span class="at">data =</span> dietData)</span>
<span id="cb150-2"><a href=""></a><span class="fu">shapiro.test</span>(anova.tukey<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  anova.tukey$residuals
W = 0.98329, p-value = 0.3995</code></pre>
</div>
</div>
<p>therefore we have normality</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href=""></a>anova.tukey <span class="ot">=</span> <span class="fu">aov</span>(Weight.Loss <span class="sc">~</span> <span class="fu">factor</span>(Diet), <span class="at">data =</span> dietData)</span>
<span id="cb152-2"><a href=""></a><span class="fu">summary</span>(anova.tukey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
factor(Diet)  2   69.4    34.7   6.551 0.00239 **
Residuals    75  397.3     5.3                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>therefore the means bewtween the groups are not the same</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href=""></a><span class="fu">TukeyHSD</span>(anova.tukey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Weight.Loss ~ factor(Diet), data = dietData)

$`factor(Diet)`
         diff        lwr      upr     p adj
2-1 0.3796296 -1.1643251 1.923584 0.8270005
3-1 2.1574074  0.6134526 3.701362 0.0036876
3-2 1.7777778  0.2799216 3.275634 0.0159151</code></pre>
</div>
</div>
<p>only the comparison between groups 3 and 1 do have a <strong>p-value</strong> that indicate they might have different means</p>
<p><br></p>
<h4 id="example-2-1">Example 2 :</h4>
<p>We create our dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href=""></a><span class="co"># response variable</span></span>
<span id="cb156-2"><a href=""></a>size <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">22</span>,<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">24</span>,<span class="dv">22</span>,<span class="dv">21</span>,<span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">30</span>,<span class="dv">25</span>,<span class="dv">24</span>,<span class="dv">21</span>,<span class="dv">27</span>,<span class="dv">28</span>,<span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">24</span>,<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">24</span>,<span class="dv">23</span>,<span class="dv">22</span>,<span class="dv">24</span>,<span class="dv">20</span>,<span class="dv">19</span>,<span class="dv">21</span>,<span class="dv">22</span>)</span>
<span id="cb156-3"><a href=""></a></span>
<span id="cb156-4"><a href=""></a><span class="co"># predictor variable</span></span>
<span id="cb156-5"><a href=""></a>location <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ForestA"</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">"ForestB"</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">"ForestC"</span>,<span class="dv">10</span>)))</span>
<span id="cb156-6"><a href=""></a></span>
<span id="cb156-7"><a href=""></a><span class="co"># dataframe</span></span>
<span id="cb156-8"><a href=""></a>my.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(size,location)</span>
<span id="cb156-9"><a href=""></a><span class="fu">head</span>(my.dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  size location
1   25  ForestA
2   22  ForestA
3   28  ForestA
4   24  ForestA
5   26  ForestA
6   24  ForestA</code></pre>
</div>
</div>
<p>we check the homegeniety of variance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href=""></a><span class="fu">leveneTest</span>(size <span class="sc">~</span> location, <span class="at">data =</span> my.dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2  0.4919 0.6168
      27               </code></pre>
</div>
</div>
<p>according to the <strong>p-value</strong> we have the homogeneity of variance</p>
<p>we check for the normality</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href=""></a><span class="fu">shapiro.test</span>(size[<span class="dv">1-10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  size[1 - 10]
W = 0.97115, p-value = 0.5913</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href=""></a><span class="fu">shapiro.test</span>(size[<span class="dv">11-20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  size[11 - 20]
W = 0.97115, p-value = 0.5913</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href=""></a><span class="fu">shapiro.test</span>(size[<span class="dv">21-30</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  size[21 - 30]
W = 0.97115, p-value = 0.5913</code></pre>
</div>
</div>
<p>according to the <strong>p-values</strong> we have the normality</p>
<p>we perform our one-way ANOVA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href=""></a>my.ANOVA <span class="ot">=</span> <span class="fu">aov</span>(size <span class="sc">~</span> location, <span class="at">data =</span> my.dataframe)</span>
<span id="cb166-2"><a href=""></a><span class="fu">summary</span>(my.ANOVA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
location     2  66.47   33.23    7.11 0.00331 **
Residuals   27 126.20    4.67                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>according to the <strong>p-value</strong> the means of the groups are not equal</p>
<p>we then perfrom our Tukey test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href=""></a><span class="fu">TukeyHSD</span>(my.ANOVA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = size ~ location, data = my.dataframe)

$location
                diff       lwr         upr     p adj
ForestB-ForestA  1.3 -1.097245  3.69724537 0.3835917
ForestC-ForestA -2.3 -4.697245  0.09724537 0.0619108
ForestC-ForestB -3.6 -5.997245 -1.20275463 0.0025530</code></pre>
</div>
</div>
<ul>
<li><p>The output displays the results of all pairwise comparisons among the tested groups.</p></li>
<li><p>The <strong>p-value</strong> for the comparison Forest B with Forest A is bigger than <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li>Therefore their means are equal</li>
</ul></li>
<li><p>The <strong>p-value</strong> for the other comparisons are smaller than <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li>Therefore their means are NOT equal</li>
</ul></li>
</ul>
<p><br></p>
<h3 id="the-dunnett-test"><img data-src="img/logo-stat.png" style="width:3.0%"> The Dunnett test</h3>
<p><em>Often follows a one-way ANOVA</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Qualitatives (3+ groups)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li>Groups being compared must be independent</li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The means of the control group and any other groups are the equal</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-16">Example :</h4>
<p>We go back with our example from the tukey test.</p>
<p>We chose the forest A has a reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href=""></a><span class="fu">library</span>(DescTools)</span>
<span id="cb170-2"><a href=""></a><span class="fu">DunnettTest</span>(<span class="at">x =</span> my.dataframe<span class="sc">$</span>size, <span class="at">g =</span> my.dataframe<span class="sc">$</span>location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Dunnett's test for comparing several treatments with a control :  
    95% family-wise confidence level

$ForestA
                diff     lwr.ci     upr.ci   pval    
ForestB-ForestA  1.3 -0.9562769  3.5562769 0.3160    
ForestC-ForestA -2.3 -4.5562769 -0.0437231 0.0453 *  

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>The <strong>p-value</strong> for the comparison Forest B with Forest A is bigger than <span class="math inline">\(\alpha\)</span>.
<ul>
<li>Therefore their means are equal</li>
</ul></li>
<li>The <strong>p-value</strong> for the comparison Forest C with Forest A is smaller than <span class="math inline">\(\alpha\)</span>.
<ul>
<li>Therefore their means are NOT equal</li>
</ul></li>
</ul>
<p><br></p>
</section>
<section id="kruskal-wallis-test" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Kruskal-Wallis test</h2>
<p><em>Non parametric equivalent to the one-way ANOVA</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Ordinal / Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Qualitatives (3+ groups)</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong></p>
<ul>
<li><p>the observations are independent</p></li>
<li><p>similar sample size</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>The mean ranks of the groups are the same.</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-17">Example :</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/NVlctlg_sIA?si=kVO0b7MILSJ2vjdX" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href=""></a>sprayData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data_raw/97_Data_File.csv"</span>,</span>
<span id="cb172-2"><a href=""></a>    <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb172-3"><a href=""></a><span class="fu">head</span>(sprayData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Type.A Type.B Type.C Type.D Type.E Type.F
1     10     11      0      3      3     11
2      7     17      1      5      5      9
3     20     21      7     12      3     15
4     14     11      2      6      5     22
5     14     16      3      4      3     15
6     12     14      1      3      6     16</code></pre>
</div>
</div>
<p>we perform our Kruskal-Wallis test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href=""></a>kwTest <span class="ot">=</span> <span class="fu">kruskal.test</span>(sprayData)</span>
<span id="cb174-2"><a href=""></a>kwTest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  sprayData
Kruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10</code></pre>
</div>
</div>
<p>we get a very small <strong>p-value</strong>, therefore we can reject H0</p>
</section>
<section id="correlation-s-tests" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Correlation-s tests</h2>
<p><em>Non parametric equivalent to the one-way ANOVA</em></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Dependent variable</th>
<th>Continuous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Independant variable</td>
<td>Continuous</td>
</tr>
</tbody>
</table>
<p><strong>Asumptions :</strong><br>
</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>H0 : Null hypothesis</strong></p>
</div>
<div class="callout-content">
<p>There is no linear relationship</p>
</div>
</div>
</div>
<p><br></p>
<h4 id="example-18">Example :</h4>
<p>We load the required packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href=""></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correlation coefficient can be computed using the functions <code>cor</code> or <code>cor.test</code></p>
<p>we can choose between 3 methods :</p>
<ul>
<li><code>pearson</code></li>
<li><code>kendall</code></li>
<li><code>spearman</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href=""></a>my_data <span class="ot">&lt;-</span> mtcars</span>
<span id="cb177-2"><a href=""></a><span class="fu">head</span>(my_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>we plot our data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href=""></a><span class="fu">ggscatter</span>(my_data, <span class="at">x =</span> <span class="st">"mpg"</span>, <span class="at">y =</span> <span class="st">"wt"</span>, </span>
<span id="cb179-2"><a href=""></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb179-3"><a href=""></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb179-4"><a href=""></a>          <span class="at">xlab =</span> <span class="st">"Miles/(US) gallon"</span>, <span class="at">ylab =</span> <span class="st">"Weight (1000 lbs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-100-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>The Pearson correlation test</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href=""></a><span class="fu">cor.test</span>(my_data<span class="sc">$</span>wt, my_data<span class="sc">$</span>mpg, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  my_data$wt and my_data$mpg
t = -9.559, df = 30, p-value = 1.294e-10
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.9338264 -0.7440872
sample estimates:
       cor 
-0.8676594 </code></pre>
</div>
</div>
<ul>
<li>The <strong>p-value</strong> is less than <span class="math inline">\(\alpha\)</span></li>
<li>We can conclude that <code>wt</code> and <code>mpg</code> are significantly correlated with a correlation coefficient of <span class="math inline">\(-0.87\)</span></li>
</ul>
<p><strong>Kendall rank correlation test</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href=""></a><span class="fu">cor.test</span>(my_data<span class="sc">$</span>wt, my_data<span class="sc">$</span>mpg,  <span class="at">method=</span><span class="st">"kendall"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  my_data$wt and my_data$mpg
z = -5.7981, p-value = 6.706e-09
alternative hypothesis: true tau is not equal to 0
sample estimates:
       tau 
-0.7278321 </code></pre>
</div>
</div>
<p>same conclusion as the Pearson correlation test</p>
<p><strong>Spearman rank correlation coefficient</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href=""></a><span class="fu">cor.test</span>(my_data<span class="sc">$</span>wt, my_data<span class="sc">$</span>mpg,  <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  my_data$wt and my_data$mpg
S = 10292, p-value = 1.488e-11
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
-0.886422 </code></pre>
</div>
</div>
<p>same conclusion as the previous correlation tests</p>
</section>
<section id="multiple-linear-regression" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Multiple Linear regression</h2>
<p>Few packages that are very useful to perform <strong>multiple linear regression</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb186-2"><a href=""></a><span class="fu">library</span>(GGally)</span>
<span id="cb186-3"><a href=""></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We “produce” data (FYI)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb187-2"><a href=""></a>x1 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">60</span>,<span class="dv">100</span>,<span class="dv">300</span>)</span>
<span id="cb187-3"><a href=""></a>x2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">60</span>,<span class="dv">20</span>,<span class="dv">120</span>)</span>
<span id="cb187-4"><a href=""></a>y <span class="ot">=</span> <span class="dv">20</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>x1 <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">60</span>,<span class="dv">0</span>,<span class="dv">40</span>)</span>
<span id="cb187-5"><a href=""></a>df <span class="ot">=</span> <span class="fu">tibble</span>(x1,x2,y)</span>
<span id="cb187-6"><a href=""></a>new_x1 <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">120</span>, <span class="at">to =</span> <span class="dv">300</span>, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb187-7"><a href=""></a>new_x2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">110</span>)</span>
<span id="cb187-8"><a href=""></a>new_data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x1 =</span> new_x1, <span class="at">x2 =</span> new_x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>our dataset is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href=""></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     x1    x2     y
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  137.  97.0  205.
2  240. 109.   737.
3  215.  82.5  603.
4  134.  46.0  423.
5  289. 106.   878.
6  289.  63.7  951.</code></pre>
</div>
</div>
<h3 id="assumptions">Assumptions</h3>
<p>Model of the form</p>
<p><span class="math display">\[y \sim \beta_0+\displaystyle\sum_{k=1}^p \beta_k x_k+\epsilon_i\]</span></p>
<ul>
<li>Assumes Linear relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x_1, x_2, \ldots, x_p\)</span></li>
<li>Assumes the irreducible error (<span class="math inline">\(\epsilon_i\)</span>) is normally distributed</li>
<li>Assumes homoscedacisity, that is <span class="math inline">\(\epsilon_i\)</span> does not depend on <span class="math inline">\(x_1, x_2, \ldots, x_p\)</span></li>
<li>In this model, the variables <span class="math inline">\(x_i\)</span> do not interact</li>
<li>Always watch out for outliers !</li>
</ul>
<h3 id="a-first-look-at-the-data">A first look at the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href=""></a><span class="fu">ggpairs</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-107-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="the-model">The model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href=""></a>model <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> df)</span>
<span id="cb191-2"><a href=""></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-72.286 -34.102  -2.892  30.163  87.738 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -35.39079   24.19773  -1.463    0.149    
x1            4.15232    0.08981  46.235   &lt;2e-16 ***
x2           -2.66124    0.19657 -13.539   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 43.2 on 57 degrees of freedom
Multiple R-squared:  0.9772,    Adjusted R-squared:  0.9764 
F-statistic:  1220 on 2 and 57 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<h3 id="few-graphs-to-undersand-the-model">Few graphs to undersand the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href=""></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-109-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-109-2.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-109-3.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-109-4.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="predictions">Predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href=""></a>new_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
      x1    x2
   &lt;dbl&gt; &lt;dbl&gt;
 1  120  101. 
 2  129.  54.1
 3  139.  74.4
 4  148.  90.4
 5  158. 107. 
 6  167. 106. 
 7  177.  56.7
 8  186.  71.3
 9  196.  41.9
10  205.  58.5
11  215.  86.4
12  224.  36.4
13  234.  50.1
14  243.  34.1
15  253.  89.1
16  262.  31.1
17  272.  33.4
18  281.  52.5
19  291.  33.3
20  300   80.6</code></pre>
</div>
</div>
<p><span class="math inline">\(\to\)</span> We want to “predict” the <strong>y</strong> according to these x1 and x2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href=""></a>fit <span class="ot">=</span> <span class="fu">predict</span>(model,new_data)</span>
<span id="cb196-2"><a href=""></a>new_data<span class="sc">$</span>predict <span class="ot">=</span> fit</span>
<span id="cb196-3"><a href=""></a>new_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
      x1    x2 predict
   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1  120  101.     193.
 2  129.  54.1    358.
 3  139.  74.4    344.
 4  148.  90.4    340.
 5  158. 107.     337.
 6  167. 106.     377.
 7  177.  56.7    548.
 8  186.  71.3    548.
 9  196.  41.9    666.
10  205.  58.5    661.
11  215.  86.4    626.
12  224.  36.4    799.
13  234.  50.1    802.
14  243.  34.1    883.
15  253.  89.1    777.
16  262.  31.1    970.
17  272.  33.4   1003.
18  281.  52.5    992.
19  291.  33.3   1082.
20  300   80.6    996.</code></pre>
</div>
</div>
</section></section>
<section>
<section id="factor-analysis" class="title-slide slide level1 center">
<h1>Factor analysis</h1>

</section>
<section id="principal-component-analysis" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Principal Component Analysis</h2>
<h3 id="problem-3">Problem</h3>
<p>We are working with a problem with way too many dimensions</p>
<h3 id="goals">Goals</h3>
<ol type="1">
<li><p><strong>Dimension reduction</strong> to a few dimensions while explaining most of the variance</p></li>
<li><p><strong>Find one-dimensional</strong> index that separates objects best</p></li>
</ol>
<h3 id="intuition">Intuition</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Find low-dimensional projection with largest spread</p>
</div>
</div>
</div>
<p><img data-src="./img/pca-intution-1.png"></p>
<p><img data-src="./img/pca-intution-2.png"></p>
<p><img data-src="./img/pca-intution-3.png"></p>
<ul>
<li><p>Dimension reduction : Only keep coordinate of first (few) <strong>P</strong>rincipal <strong>C</strong>omponent (PC)</p></li>
<li><p>Rotated basis :</p>
<ul>
<li>Vector 1 : Largest variance (1st PC)</li>
<li>Vector 2 : Perpendicular (2nd PC)</li>
</ul></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">x1</th>
<th style="text-align: left;">x2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Std. Basis</td>
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC Basis</td>
<td style="text-align: left;">0.7</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">After Dim. Reduc.</td>
<td style="text-align: left;">0.7</td>
<td style="text-align: left;">-</td>
</tr>
</tbody>
</table>
<h3 id="orthogonal-directions">Orthogonal directions</h3>
<ul>
<li><p><strong>PC</strong> 1 is the direction with largest variance</p></li>
<li><p><strong>PC</strong> 2 is :</p>
<ul>
<li>perpendicular to PC 1</li>
<li>again largest variance</li>
</ul></li>
<li><p><strong>PC</strong> 3 is :</p>
<ul>
<li>perpendicular to PC 1, PC 2</li>
<li>again largest variance</li>
</ul></li>
<li><p>…</p></li>
</ul>
<p><img data-src="./img/pca-orthogonal-directions.png"></p>
<h3 id="which-kinds-of-data">Which kinds of data ?</h3>
<p><strong>PCA</strong> applies to data tables where : - rows are considered as individuals - and columns as quantitative variables</p>
<h3 id="example-19">Example :</h3>
<p>The data :</p>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(P\)</span> <span class="math inline">\(\left(\text{cm}\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{max}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{min}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">12,04</td>
<td style="text-align: left;">23,7</td>
<td style="text-align: left;">5,9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">17,18</td>
<td style="text-align: left;">15,5</td>
<td style="text-align: left;">-1,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">11,83</td>
<td style="text-align: left;">13,1</td>
<td style="text-align: left;">2,8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">6,23</td>
<td style="text-align: left;">13,5</td>
<td style="text-align: left;">-2,4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">16,99</td>
<td style="text-align: left;">21,1</td>
<td style="text-align: left;">7,2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">3,87</td>
<td style="text-align: left;">20,3</td>
<td style="text-align: left;">-0,9</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: left;">11,36</td>
<td style="text-align: left;">17,87</td>
<td style="text-align: left;">1,8</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
<td style="text-align: left;">4,98</td>
<td style="text-align: left;">4,04</td>
<td style="text-align: left;">3,76</td>
</tr>
</tbody>
</table>
<p>We can center and reduce this dataset using the relation</p>
<p><span class="math display">\[x_{i k}=\frac{x_{i k}-\overline{X_k}}{\sigma_k}\]</span> we get</p>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(P\)</span> <span class="math inline">\(\left(\text{cm}\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{max}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{min}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">0,14</td>
<td style="text-align: left;">1,44</td>
<td style="text-align: left;">1,09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">1,17</td>
<td style="text-align: left;">-0,59</td>
<td style="text-align: left;">-0,96</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">0,10</td>
<td style="text-align: left;">-1,18</td>
<td style="text-align: left;">0,27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">-1,03</td>
<td style="text-align: left;">-1,08</td>
<td style="text-align: left;">-1,12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">1,13</td>
<td style="text-align: left;">0,80</td>
<td style="text-align: left;">1,44</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">-1,50</td>
<td style="text-align: left;">0,60</td>
<td style="text-align: left;">-0,72</td>
</tr>
</tbody>
</table>
<p>We call it <span class="math inline">\(X_{cr}\)</span></p>
<p><span class="math display">\[X_{cr} =\left[\begin{array}{rrr}0,14 &amp; 1,44 &amp; 1,09 \\ 1,17 &amp; -0,59 &amp; -0,96 \\ 0,10 &amp; -1,18 &amp; 0,27 \\ -1,03 &amp; -1,08 &amp; -1,12 \\ 1,13 &amp; 0,80 &amp; 1,44 \\ -1,50 &amp; 0,60 &amp; -0,72\end{array}\right]\]</span></p>
<p>we can define the <strong>correlation Matrix</strong></p>
<table class="caption-top">
<colgroup>
<col style="width: 21%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(P\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{max}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{min}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(r\left(P, T_{\text{max} }\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(P, T_{\text{min} }\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{\text{max} }\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{max} }, P\right)\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{max} }, T_{\text{min} }\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{\text{min} }\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{min} }, P\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{min} }, T_{\text{max} }\right)\)</span></td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(r\)</span> are the correlations between 2 variables</p>
<p><span class="math display">\[r\left(P, T_{\text{max} }\right) = r\left(T_{\text{max} }, P\right)\]</span></p>
<p><span class="math display">\[C = \frac{1}{N} \ X_{cr}^T \ X_{cr}\]</span> where here <span class="math inline">\(N=6\)</span>.</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(P\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{max} }\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{min} }\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0,09</td>
<td style="text-align: center;">0,49</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{\text{max} }\)</span></td>
<td style="text-align: center;">0,09</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0,62</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{\text{min} }\)</span></td>
<td style="text-align: center;">0,49</td>
<td style="text-align: center;">0,62</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>We write</p>
<p><span class="math display">\[C =
\begin{pmatrix}
1 &amp; 0.09 &amp; 0.49 \\
0.09 &amp; 1 &amp; 0.62 \\
0.49 &amp; 0.62 &amp; 1
\end{pmatrix}\]</span></p>
<p>we then look for eigenvalues and eigenvectors. We find</p>
<ul>
<li><span class="math inline">\(\lambda_1 = 1,83\quad\)</span> with <span class="math inline">\(\quad v_1=\begin{pmatrix} 0.46 \\ 0.56 \\ 0.69 \end{pmatrix}\)</span></li>
<li><span class="math inline">\(\lambda_2 = 0.92\quad\)</span> with <span class="math inline">\(\quad v_2=\begin{pmatrix} 0.79 \\ -0.61 \\ -0.03 \end{pmatrix}\)</span></li>
<li><span class="math inline">\(\lambda_3 = 0.25\quad\)</span> with <span class="math inline">\(\quad v_3=\begin{pmatrix} 0.41 \\ 0.56 \\ -0.72 \end{pmatrix}\)</span></li>
</ul>
<p>The <strong>Inertia</strong> (generalized variance) is given by</p>
<p><span class="math display">\[
\mbox{Total inertia} = \sum \mbox{eigenvalues} \ = 3
\]</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Eigenvalue</th>
<th style="text-align: left;">Inertia (%)</th>
<th style="text-align: left;">Inertia Cumul. (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\lambda_1\)</span></td>
<td style="text-align: left;">1,83</td>
<td style="text-align: left;">61,17</td>
<td style="text-align: left;">61,17</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\lambda_2\)</span></td>
<td style="text-align: left;">0,92</td>
<td style="text-align: left;">30,51</td>
<td style="text-align: left;">91,68</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\lambda_3\)</span></td>
<td style="text-align: left;">0,25</td>
<td style="text-align: left;">8,32</td>
<td style="text-align: left;">100,00</td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="./img/acp-ex-1.png"></p>
</div><div class="column" style="width:25%;">
<p><img data-src="./img/acp-ex-2.png"></p>
</div><div class="column" style="width:25%;">
<p><img data-src="./img/acp-ex-3.png"></p>
</div></div>
<p><strong>Principal components</strong></p>
<p>In order to get the principal components we compute</p>
<p><span class="math display">\[F_1 = X_{cr} v_1 \quad \mbox{ and } \quad F_2 = X_{cr} v_2\]</span></p>
<p>We get</p>
<p><span class="math display">\[F_1 = \begin{pmatrix} 1,63 \\ -0,45 \\ -0,43 \\ -1,85 \\ 1,96 \\ -0,85 \end{pmatrix} \quad \mbox{ and } \quad F_2 = \begin{pmatrix}-0,81 \\ 1,31 \\ 0,79 \\ -0,12 \\ 0,37 \\ -1,54\end{pmatrix}\]</span> These two vectors form a plane which have <span class="math inline">\(~92 \%\)</span> of the (generalized) variance. We can represent the indivuals and the variables in this plane with the coorelation circle</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(\mathrm{F}_1\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\mathrm{F}_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">1,63</td>
<td style="text-align: left;">-0,81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">-0,45</td>
<td style="text-align: left;">1,31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">-0,43</td>
<td style="text-align: left;">0,79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">-1,85</td>
<td style="text-align: left;">-0,12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">1,96</td>
<td style="text-align: left;">0,37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">-0,85</td>
<td style="text-align: left;">-1,54</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: left;">1,83</td>
<td style="text-align: left;">0,92</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(r(P,F_1) = \mbox{First coordinate of } v_1 \times \sqrt{\lambda_1} = 0.62\)</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(F_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(F_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0,62\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0,76\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{\text{max} }\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0,76\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-0,59\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{\min }\)</span></td>
<td style="text-align: center;">0,93</td>
<td style="text-align: center;"><span class="math inline">\(-0,03\)</span></td>
</tr>
</tbody>
</table>
<p>Time to look at an example</p>
</section>
<section id="first-example-of-pca" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> First example of PCA</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/c_NvVOQK8kk?si=RDiZt_Dsc64xJfzt" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href=""></a><span class="fu">data</span>(<span class="st">"iris"</span>)</span>
<span id="cb198-2"><a href=""></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
<p>we modify a bit the data for this example :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb200-2"><a href=""></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(iris),</span>
<span id="cb200-3"><a href=""></a>              <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-4"><a href=""></a>              <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>))</span>
<span id="cb200-5"><a href=""></a>training <span class="ot">&lt;-</span> iris[ind<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb200-6"><a href=""></a>testing <span class="ot">&lt;-</span> iris[ind<span class="sc">==</span><span class="dv">2</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>let’s do the principal component analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href=""></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(training[,<span class="sc">-</span><span class="dv">5</span>],</span>
<span id="cb201-2"><a href=""></a>             <span class="at">center =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-3"><a href=""></a>            <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb201-4"><a href=""></a><span class="fu">attributes</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href=""></a><span class="fu">print</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviations (1, .., p=4):
[1] 1.7173318 0.9403519 0.3843232 0.1371332

Rotation (n x k) = (4 x 4):
                    PC1         PC2        PC3        PC4
Sepal.Length  0.5147163 -0.39817685  0.7242679  0.2279438
Sepal.Width  -0.2926048 -0.91328503 -0.2557463 -0.1220110
Petal.Length  0.5772530 -0.02932037 -0.1755427 -0.7969342
Petal.Width   0.5623421 -0.08065952 -0.6158040  0.5459403</code></pre>
</div>
</div>
<p>we have the principal components</p>
<p>For making biplot need devtools package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href=""></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb205-2"><a href=""></a>g <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(pc,</span>
<span id="cb205-3"><a href=""></a>              <span class="at">obs.scale =</span> <span class="dv">1</span>,</span>
<span id="cb205-4"><a href=""></a>              <span class="at">var.scale =</span> <span class="dv">1</span>,</span>
<span id="cb205-5"><a href=""></a>              <span class="at">groups =</span> training<span class="sc">$</span>Species,</span>
<span id="cb205-6"><a href=""></a>              <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-7"><a href=""></a>              <span class="at">circle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-8"><a href=""></a>              <span class="at">ellipse.prob =</span> <span class="fl">0.68</span>)</span>
<span id="cb205-9"><a href=""></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">''</span>)</span>
<span id="cb205-10"><a href=""></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.direction =</span> <span class="st">'horizontal'</span>,</span>
<span id="cb205-11"><a href=""></a>               <span class="at">legend.position =</span> <span class="st">'top'</span>)</span>
<span id="cb205-12"><a href=""></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-116-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>PC1 explains about 73.7% and PC2 explained about 22.1% of variability.</p>
<p>Arrows are closer to each other indicates the high correlation.</p>
<p>For example correlation between Sepal Width vs other variables is weakly correlated.</p>
<p>Another way interpreting the plot is PC1 is positively correlated with the variables Petal Length, Petal Width, and Sepal Length, and PC1 is negatively correlated with Sepal Width.</p>
<p>PC2 is highly negatively correlated with Sepal Width.</p>
<p>Bi plot is an important tool in PCA to understand what is going on in the dataset.</p>
</section>
<section id="hierarchical-clustering-analysis" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> Hierarchical clustering analysis</h2>
<p>cf.&nbsp;your notes</p>
</section>
<section id="first-example-of-hca" class="slide level2 scrollable">
<h2><img data-src="img/scroll.png" style="width:1.0%"> First example of HCA</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/r_bowNoNrg8?si=zr_8iHgz3cGvwcwb" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<p>we load the required packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb206-2"><a href=""></a><span class="fu">library</span>(NbClust)</span>
<span id="cb206-3"><a href=""></a><span class="fu">library</span>(cluster) </span>
<span id="cb206-4"><a href=""></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>we load the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href=""></a>data.cluster <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data_raw/food-bank.csv"</span>,<span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb207-2"><a href=""></a><span class="fu">head</span>(data.cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       V1      V2
1 0.04769 0.21150
2 0.05249 0.02238
3 0.10669 0.08343
4 0.14947 0.10921
5 0.18864 0.04716
6 0.19818 0.15651</code></pre>
</div>
</div>
<p>we plot the data in the basis (V1,V2)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href=""></a><span class="fu">ggplot</span>(data.cluster)<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>V1,<span class="at">y=</span>V2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-119-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>we want to cluster the coordinates</p>
<p>we define the euclidean distance (it is a choice that makes sense in this case)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href=""></a>dd <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">scale</span>(data.cluster[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="at">method =</span> <span class="st">"euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>with <code>dd</code>we get the distance between every coodinates.</p>
<p>we can now regroup the coordinates using the <code>ward.D2</code> method</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href=""></a><span class="co"># hierarchical clustering</span></span>
<span id="cb211-2"><a href=""></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dd, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb211-3"><a href=""></a><span class="fu">plot</span>(hc,<span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>,<span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-121-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>the graph with all the clusters is called a <strong>dendogram</strong></p></li>
<li><p>we have to decide where to cut this dendogram to have groups to work with</p></li>
<li><p>we plot the heights of this cluster analysis</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href=""></a><span class="fu">barplot</span>(<span class="fu">diff</span>(hc<span class="sc">$</span>height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-122-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>we will cut the tree at a given number of clusters and obtain the associated cluster for each observation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href=""></a><span class="fu">plot</span>(hc,<span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>,<span class="at">labels =</span> F)</span>
<span id="cb213-2"><a href=""></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(hc<span class="sc">$</span>height[<span class="dv">38</span><span class="sc">:</span><span class="dv">39</span>]),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb213-3"><a href=""></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(hc<span class="sc">$</span>height[<span class="dv">36</span><span class="sc">:</span><span class="dv">37</span>]),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-123-1.png" width="960"></p>
</figure>
</div>
</div>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="img/Logo_ISTOM.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://ant0in3g.github.io/">Statistics and data analysis</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="slides_en_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="slides_en_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="slides_en_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"normal","numbers":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>