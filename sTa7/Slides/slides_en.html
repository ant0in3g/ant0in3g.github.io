<!DOCTYPE html>
<html lang="en"><head>
<script src="slides_en_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides_en_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides_en_files/libs/quarto-html/popper.min.js"></script>
<script src="slides_en_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides_en_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides_en_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="slides_en_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Antoine Géré">
  <title>Statistics and data analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="slides_en_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="slides_en_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="slides_en_files/libs/revealjs/dist/theme/quarto-2f366650f320edcfcf53d73c80250a32.css">
  <link rel="stylesheet" href="styles.css">
  <link href="slides_en_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="slides_en_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="slides_en_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="slides_en_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistics and data analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Antoine Géré 
</div>
</div>
</div>

</section>
<section>
<section id="general-informations" class="title-slide slide level1 center">
<h1>General informations</h1>

</section>
<section id="organization" class="slide level2">
<h2>Organization</h2>
<p><br></p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">S2</th>
<th style="text-align: center;">S3</th>
<th style="text-align: center;">S4</th>
<th style="text-align: center;">S5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lectures</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
</tr>
<tr class="even">
<td>Tutorials</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
<td style="text-align: center;">8 (12h)</td>
</tr>
<tr class="odd">
<td>tot.</td>
<td style="text-align: center;">16 (24h)</td>
<td style="text-align: center;">16 (24h)</td>
<td style="text-align: center;">16 (24h)</td>
<td style="text-align: center;">16 (24h)</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li><strong>Lectures</strong> : no need to bring your personal computer</li>
<li><strong>Tutorials</strong> : bring your personal computer</li>
</ul>
<p><br></p>
<p><a href="https://ant0in3g.github.io/sTa7.html" class="uri">https://ant0in3g.github.io/sTa7.html</a> <span class="math inline">\(\to\)</span> look at your stickers !</p>
</section>
<section id="evaluations-and-group-projets" class="slide level2">
<h2>Evaluations and Group projets</h2>
<p><br><br></p>
<div class="columns">
<div class="column" style="width:32%;">
<h3 id="evaluations">Evaluations</h3>
<p>For each semester :</p>
<ul>
<li>One mid-semester exam (1h30)</li>
<li>One final exam (1h30)</li>
</ul>
</div><div class="column" style="width:6%;">

</div><div class="column" style="width:62%;">
<h3 id="group-projets">Group projets</h3>
<ul>
<li><p><strong>Semester 2 :</strong></p>
<div style="text-align:center;">
<p><a href="https://ant0in3g.github.io/sTa7/PASD/PASD.html"><strong>P</strong>remière <strong>A</strong>nalyse en <strong>S</strong>tatistique <strong>D</strong>escriptive (PASD)</a></p>
</div></li>
<li><p><strong>Semester 4 :</strong></p>
<div style="text-align:center;">
<p><a href="https://ant0in3g.github.io/sTa7/PEAD/PEAD.html"><strong>P</strong>remière <strong>E</strong>xpérience en <strong>A</strong>nalyse de <strong>D</strong>onnées (PEAD)</a></p>
</div></li>
<li><p><strong>Semester 6 :</strong></p>
<div style="text-align:center;">
<p><a href="https://ant0in3g.github.io/sTa7/PIDEx/PIDEx.html"><strong>P</strong>rojet d’<strong>I</strong>nitiation à la <strong>D</strong>émarche <strong>Ex</strong>périmentale (PIDEx)</a></p>
</div></li>
</ul>
</div></div>
</section>
<section id="resources-and-onedrive-folder" class="slide level2">
<h2>Resources and OneDrive folder</h2>
<h3 id="resources">Resources</h3>
<ul>
<li><p><a href="https://ant0in3g.github.io/sTa7/Slides/slides.html">Slides du cours</a></p></li>
<li><p><a href="https://ant0in3g.github.io/sTa7/LectureStat/index.html">Cours complet de Statistiques et analyse de données</a> (en construction)</p></li>
<li><p><a href="https://ant0in3g.github.io/sTa7/td-s.html">Travaux dirigés</a></p></li>
<li><p><a href="https://ant0in3g.github.io/sTa7/examens.html">Sujets d’examens corrigées des années passées</a></p></li>
<li><p><a href="https://www.statlearning.com/">An Introduction to Statistical Learning from the Stanford University</a> with a <a href="https://www.youtube.com/playlist?list=PLoROMvodv4rOzrYsAxzQyHb8n_RWNuS1e">YouTube playlist</a> of the lectures</p></li>
</ul>
<h3 id="shared-onedrive-folder">Shared OneDrive folder</h3>
<p><em>A OneDrive folder has been shared with every student</em></p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>To Do !</strong></p>
</div>
<div class="callout-content">
<p><a href="https://ant0in3g.github.io/sTa7/orga.html">Synchornize this folder on your laptop <strong>OR</strong> create a shortcut on your own OneDrvive</a></p>
</div>
</div>
</div>
</section></section>
<section>
<section id="introduction-to-statistics-andwith-r" class="title-slide slide level1 center">
<h1>Introduction to statistics and/with R</h1>
<p><br></p>
<ul>
<li><strong>Data</strong> : interesting</li>
</ul>
<p><span class="math inline">\(\to\)</span> they help us <strong>understand the world</strong> !</p>
<p><br></p>
<ul>
<li><strong>Statistics</strong> : fundamental in <strong>science</strong></li>
</ul>
<p><span class="math inline">\(\to\)</span> needed in the design, analysis, and interpretation of experiments !</p>
</section>
<section id="a-brief-intro-to-r-and-rstudio" class="slide level2 scrollable">
<h2>A brief intro to R and RStudio</h2>
<p><img data-src="img/R_RStudio_LogoS.png" style="width:70.0%"></p>
<ul>
<li>Free open source language</li>
<li>Built to do statistics</li>
<li>Updated by the mathematician from all over the world</li>
<li>Amazing graphics !</li>
<li>Widely used in biology, agronomy, economy, …</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>R and RStudio</strong></p>
</div>
<div class="callout-content">
<p><strong>Learn it, love it, use it !</strong></p>
</div>
</div>
</div>
<p><br></p>
<h3 id="installation-of-r-and-rstudio">Installation of R and RStudio</h3>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>To Do !</strong></p>
</div>
<div class="callout-content">
<p>Install R and RStudio for next class !</p>
</div>
</div>
</div>
<p><br></p>
<h3 id="good-habits">Good habits</h3>
<ul>
<li>create a <strong>project</strong> on RStudio</li>
<li>create ALWAYS <strong>4 folders</strong> :
<ul>
<li><code>data_raw</code></li>
<li><code>data</code></li>
<li><code>img</code></li>
<li><code>doc</code></li>
</ul></li>
<li>Use the <code>help</code> function ! … and also <code>chat GPT</code> …<br>
<strong>WARNING ! It often writes code wayyyy too complicated !</strong></li>
<li><strong>What you see in your OneDrive folder</strong> :</li>
</ul>
<p><img data-src="img/onedrive-folder.png" style="width:50.0%"></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Launch RStudio</strong></p>
</div>
<div class="callout-content">
<p>Always launch your <strong>RStudio project</strong> with</p>
<p><img data-src="img/launch-RStudio.png" style="width:150.0%"></p>
</div>
</div>
</div>
<p><br></p>
<h3 id="using-rstudio">Using RStudio</h3>
<p><img data-src="img/rstudio-1st-time.png"></p>
<p><br></p>
<h3 id="import-data-into-rstudio">Import DATA into RStudio</h3>
<ul>
<li>Data used for this class : <a href="https://istom-my.sharepoint.com/:x:/g/personal/a_gere_istom_fr/EW43vM6YV45LuPoLzg8oxlEB4bBEy3gdX2Cjh84sbcx-uQ?e=qTJp3O"><strong><code>Data.Lecture.xlsx</code></strong></a></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><strong>You can download it by clicking on <a href="https://istom-my.sharepoint.com/:x:/g/personal/a_gere_istom_fr/EW43vM6YV45LuPoLzg8oxlEB4bBEy3gdX2Cjh84sbcx-uQ?e=qTJp3O"><strong><code>Data.Lecture.xlsx</code></strong></a> !</strong></p>
</div>
</div>
</div>
<ul>
<li>Import data from an <strong>excel</strong> file</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href=""></a>my.data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data_raw/Data.Lecture.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Possible to import data from many more file formats …</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Let’s get started</strong></p>
</div>
<div class="callout-content">
<p><strong>NOW “doing statistics” can get started !</strong></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="general-framework" class="slide level2 scrollable">
<h2>General framework</h2>
<div class="columns">
<div class="column">
<p><img data-src="img/global_view_stat.png" style="width:80.0%"></p>
</div><div class="column">
<p>What we are going to learn :</p>
<ul>
<li>Descriptive Statistics</li>
<li>Probability theory</li>
<li>Sample theory</li>
<li>Inferential Statistics</li>
</ul>
</div></div>
<p><br></p>
<h3 id="statistical-variables">Statistical Variables</h3>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Def.</strong></p>
</div>
<div class="callout-content">
<ul>
<li>A <strong>variable</strong> <span class="math inline">\(X\)</span> is any characteristic observed in a study.</li>
<li>The data values that we observe for a variable are called <strong>observations</strong></li>
</ul>
</div>
</div>
</div>
<ul>
<li><strong>Unit / individual</strong> : A member of a population</li>
<li><strong>Population</strong> : The collection of all individuals / units that we want to know more about</li>
<li><strong>Sample</strong> : The subset of the population we observe</li>
<li><strong>Modality</strong> : The distinct values or categories that the variable can take</li>
</ul>
<p><br></p>
<h3 id="example">Example</h3>
<p><strong>Variable</strong> : Grade in Statistics of ISTOM’s Students</p>
<p><strong>Observations</strong> : <span class="math inline">\(18,14,16,11,12,15, \ldots\)</span></p>
<ul>
<li><strong>Unit / individual</strong> : single student</li>
<li><strong>Population</strong> : all students of ISTOM</li>
<li><strong>Sample</strong> : a class</li>
<li><strong>Modality</strong> : [0 ; 20]</li>
</ul>
<p><br></p>
<h3 id="types-of-variables">Types of variables</h3>
<ul>
<li>Qualitative (Categorical)
<ul>
<li>Nominal</li>
<li>Ordinal</li>
</ul></li>
<li>Quantitative (Numerical)
<ul>
<li>Discrete</li>
<li>Continuous</li>
</ul></li>
</ul>
<p><br></p>
<h3 id="qualitative-categorical-variable">Qualitative / Categorical Variable</h3>
<p>A variable is called <strong>qualitative</strong> if <strong>each observation belongs</strong> to a <strong>set of distinct categories</strong></p>
<ul>
<li><p>Nominal : Categories are disconnected.</p>
<p><em>Examples : Hair Color, Animal Species, …</em></p></li>
<li><p>Ordinal: Categories are ranked</p>
<p><em>Examples : Level of Education, …</em></p></li>
</ul>
<p><br></p>
<h3 id="quantitative-numerical-variable">Quantitative / Numerical Variable</h3>
<p>A variable is called <strong>quantitative</strong> if observations on it take numerical values that represent different magnitudes of the variable</p>
<ul>
<li><p><strong>Discrete</strong> : the variable assume values in a countable set (“how many”)</p>
<p><em>Examples : Number of episode in a series, Grades, …</em></p></li>
<li><p><strong>Continuous</strong> : the variable assume values in a continuous set (“how much”)</p>
<p><em>Examples : Time, most physical measurements, …</em></p></li>
</ul>
</section>
<section id="exploring-data" class="slide level2 scrollable">
<h2>Exploring Data</h2>
<p>Before making statistical tests with your data it is essential to examine all your variables !</p>
<p>Why ? To “listen” to the data :</p>
<ul>
<li>to catch mistakes</li>
<li>to see patterns in the data</li>
<li>to find violations of statistical assumptions</li>
<li>to generate hypotheses</li>
<li>… and because if you don’t, you will have trouble later !</li>
</ul>
<h3 id="numerical-summaries-of-data">Numerical Summaries of Data</h3>
<ul>
<li><strong>Central Tendency measures</strong>. They are computed to give a “center” around which the measurements in the data are distributed.</li>
<li><strong>Variation or Variability measures</strong>. They describe “data spread” or how far away the measurements are from the center.</li>
<li><strong>Relative Standing measures</strong>. They describe the relative position of specific measurements in the data.</li>
</ul>
<h3 id="means">Mean(s)</h3>
<p><strong>The Mean</strong></p>
<p>To calculate the average <span class="math inline">\(\overline{X}\)</span> of a set of observations, add their value and divide by the number of observations</p>
<p><span class="math display">\[
\overline{x}=\frac{X_1+X_2+X_3+\ldots+X_n}{n}=\frac{1}{n} \sum_{i=1}^n x_i
\]</span></p>
<h3 id="other-mean">Other mean</h3>
<p>Weighted mean / Geometric mean / Harmonic mean / …</p>
<h3 id="median">Median</h3>
<ul>
<li><strong>Median</strong> : the exact middle value</li>
<li>Calculation :
<ul>
<li>If there are an <strong>odd number of observations</strong>, find the middle value</li>
<li>If there are an <strong>even number of observations</strong>, find the middle two values and average them</li>
</ul></li>
</ul>
<p>Example : <span class="math inline">\(17, 19, 21, 22, 23, 23, 23, 38\)</span>. The Median is <span class="math display">\[\dfrac{22+23}{2}=22.5\]</span></p>
<h3 id="which-location-measure-is-best">Which Location Measure Is Best ?</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Mean is best for symmetric distributions without outliers</li>
</ul>
<p><img data-src="img/symmetrical_distribution.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li>Median is useful for skewed distributions or data with outliers</li>
</ul>
<p><img data-src="img/skewed_distribution.png" style="width:70.0%"></p>
</div></div>
<h3 id="variance">Variance</h3>
<p>Average of squared deviations of values from the mean</p>
<p><span class="math display">\[
\sigma^2=\dfrac{\sum_\left(x_i-\bar{x}\right)^2}{n-1}
\]</span> where <span class="math inline">\(n\)</span> is the the total number of observations</p>
<ul>
<li>Absolute values do not have nice mathematical properties</li>
<li>Squares eliminate the negatives</li>
</ul>
<p><strong>Standard deviations are simply the square root of the variance</strong></p>
<h3 id="five-number-summary">Five Number Summary</h3>
<ul>
<li><p><strong>Quartiles</strong> divide data into 4 even parts</p>
<ul>
<li>first quartile <span class="math inline">\(Q_1=25\)</span> th percentile</li>
</ul>
<p><span class="math inline">\(25\%\)</span> of data fall below it and <span class="math inline">\(75\%\)</span> above it</p>
<ul>
<li><p>second quartile <span class="math inline">\(Q_2=\)</span> median <span class="math inline">\(=50\)</span> th percentile</p></li>
<li><p>third quartile <span class="math inline">\(Q_3=75\)</span> th percentile</p></li>
</ul>
<p><span class="math inline">\(75 \%\)</span> of data fall below it and 25% above it</p></li>
<li><p>Interquartile Range <span class="math inline">\((I Q R)=Q_3-Q_1\)</span></p></li>
</ul>
<p><strong>Five-Number Summary :</strong> <span class="math inline">\(\qquad \min , \quad Q_1, \quad \text { Median, } \quad Q_3, \quad \max\)</span></p>
<h3 id="example-1">Example 1</h3>
<p>For the 9 numbers: <span class="math display">\[43, 35, 43, 33, 38, 53, 64, 27, 34\]</span> give the Five-Number Summary.</p>
<h3 id="example-2">Example 2</h3>
<p>For the 10 numbers: <span class="math display">\[43, 35, 43, 33, 38, 53, 64, 27, 34, 27\]</span> give the Five-Number Summary.</p>
<h3 id="remark-careful">Remark : Careful !</h3>
<p>Statisticians don’t have a consensus on the calculation of quartiles. There are several formulas for quartiles.</p>
<p>With R for example 1, we find</p>
<p><span class="math inline">\(Q_1=34\)</span> and <span class="math inline">\(Q_2=43\)</span>.</p>
<p>Don’t worry about the formula.</p>
<p>Just keep in mind that quartiles divide data into 4 even parts.</p>
<h3 id="interesting-result">Interesting Result</h3>
<p>Regardless of how the data are distributed, <span class="math inline">\(75\%\)</span> of values fall within <span class="math inline">\(\sigma\)</span> from the mean !</p>
<p><img data-src="img/Explained_Sigma_Mean.jpg"></p>
<h3 id="categorical-qualitative-variables">Categorical / Qualitative variable(s)</h3>
<ul>
<li>Ways to summarize of a single categorical variable
<ul>
<li>Frequency tables</li>
<li>Barplots, pie charts</li>
</ul></li>
<li>Ways to summarize of relationships between two categorical variables
<ul>
<li>two-way contingency tables</li>
<li>segmented barplots, standardized segmented barplots, mosaic plot</li>
</ul></li>
</ul>
<h3 id="two-way-contingency-tables">Two-Way Contingency Tables</h3>
<p>A table that summarizes data for two categorical variables is called a <strong>contingency table</strong>.</p>
<p>Example : Numbers of vegetable produced wort by healthy and diseased</p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">Healthy</th>
<th style="text-align: right;">Diseased</th>
<th style="text-align: center;">Tot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Carrots</td>
<td style="text-align: left;">122</td>
<td style="text-align: right;">203</td>
<td style="text-align: center;">325</td>
</tr>
<tr class="even">
<td>Salads</td>
<td style="text-align: left;">167</td>
<td style="text-align: right;">118</td>
<td style="text-align: center;">285</td>
</tr>
<tr class="odd">
<td>Onions</td>
<td style="text-align: left;">528</td>
<td style="text-align: right;">178</td>
<td style="text-align: center;">706</td>
</tr>
<tr class="even">
<td>Spinach</td>
<td style="text-align: left;">623</td>
<td style="text-align: right;">212</td>
<td style="text-align: center;">885</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td style="text-align: left;">1490</td>
<td style="text-align: right;">711</td>
<td style="text-align: center;">2201</td>
</tr>
</tbody>
</table>
</section></section>
<section id="probability-and-sampling" class="title-slide slide level1 center">
<h1>Probability and sampling</h1>
<p>coming !</p>
</section>

<section>
<section id="statistical-tests" class="title-slide slide level1 center">
<h1>Statistical tests</h1>

</section>
<section id="statistical-hypothesis-tests" class="slide level2 scrollable">
<h2>Statistical hypothesis tests</h2>
<h3 id="the-hypotheses">The Hypotheses</h3>
<p>Two Competing Hypotheses :</p>
<ol type="1">
<li><strong>Null hypothesis</strong> H0 :</li>
</ol>
<p>The conservative hypothesis ; “There is nothing going on !”</p>
<ol start="2" type="1">
<li><strong>Alternative hypothesis</strong> H1 :</li>
</ol>
<p>“There is something going on”</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The next step of hypothesis testing is to weigh the evidence !</p>
<p>Could these data plausibly have happened by chance if the H0 was true?</p>
</div>
</div>
</div>
<h3 id="type-1-and-type-2-errors">Type 1 and Type 2 Errors</h3>
<p>In a hypothesis test, we make a decision about which of H0 or H1 might be true, but our decision might be incorrect !</p>

<img data-src="img/type1-2-error.png" class="r-stretch"><p>Type 1 Error (<span class="math inline">\(\alpha\)</span>) <span class="math inline">\(&gt;\)</span> Type 2 Error <span class="math inline">\((\beta)\)</span></p>
<p><span class="math inline">\(\to\)</span> we fix <span class="math inline">\(\alpha\)</span>, and try to minimize <span class="math inline">\(\beta\)</span></p>
<p>Always being cautious in our decisions !</p>
<h3 id="inside-a-statistical-hypothesis-test">“Inside” a statistical hypothesis test</h3>
<ul>
<li><p>We collect data in our population</p></li>
<li><p>We use the right test</p></li>
<li><p>We import our data in RStudio</p></li>
<li><p>We “write” the test we chose</p></li>
<li><p>And according to the <strong>p-value</strong> we get, we can accept or reject H0</p></li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>We need to learn which test to choose, how to choose it, and how to implement it on RStudio</p>
</div>
</div>
</div>
</section>
<section id="chi2-test" class="slide level2 scrollable">
<h2>Chi2 test</h2>
<p><span class="math inline">\(\to\)</span> TD !</p>
</section>
<section id="binomial-test" class="slide level2 scrollable">
<h2>Binomial test</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>We want to compare two percentages (or two numbers) with each other or with theoretical values</p>
<p><span class="math inline">\(\to\)</span> <strong>I do a binomial test</strong></p>
</div>
</div>
</div>
<h3 id="study-case">Study case</h3>
<p>In this class :</p>
<ul>
<li>how many students in this class ?</li>
<li>how many women / men ?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>women <span class="ot">=</span> <span class="dv">45</span></span>
<span id="cb2-2"><a href=""></a>men <span class="ot">=</span> <span class="dv">30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The null hypothesis H0 :</strong></p>
<p>In the world population we have around 50% women and 50% men.</p>
<p>Does the sample (P114) fit this theory ?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co">#binom.test(women,men,p=0.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\to\)</span> What is the <strong>p-value</strong> ? What can we say about H0 ?</p>
</section>
<section id="t-test" class="slide level2 scrollable">
<h2>T test</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>We want :</p>
<ul>
<li><p>to compare two means of samples in order to know if the two samples are from the same population ?</p></li>
<li><p>to compare a mean of a sample to the mean of the whole population</p></li>
</ul>
<p><span class="math inline">\(\to\)</span> We do a t test</p>
</div>
</div>
</div>
<h3 id="compare-2-samples">Compare 2 samples</h3>
<ul>
<li><p><strong>Step 1</strong> : check if the two variables are normally distributed (we still have to learn it !)</p></li>
<li><p><strong>Step 2</strong> : We do a t test on RStudio</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>)  </span>
<span id="cb4-2"><a href=""></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>) </span>
<span id="cb4-3"><a href=""></a><span class="fu">t.test</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  x and y
t = -2.2268, df = 15.006, p-value = 0.04169
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -3.3805058 -0.0740397
sample estimates:
mean of x mean of y 
 3.000000  4.727273 </code></pre>
</div>
</div>
<h3 id="compare-one-sample-to-the-mean-of-the-whole-population">Compare one sample to the mean of the whole population</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>xx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">18</span>)</span>
<span id="cb6-2"><a href=""></a><span class="fu">t.test</span>(xx, <span class="at">mu=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  xx
t = -1.9743, df = 14, p-value = 0.06842
alternative hypothesis: true mean is not equal to 19
95 percent confidence interval:
 18.02636 19.04031
sample estimates:
mean of x 
 18.53333 </code></pre>
</div>
</div>
</section>
<section id="anova" class="slide level2 scrollable">
<h2>ANOVA</h2>
<p>ANOVA (<strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance) is a statistical test to determine whether two or more population means are different.</p>
<p>It is used to compare two or more groups to see if they are significantly different.</p>
<p>In practice,</p>
<ul>
<li><p>t test is used to compare 2 groups</p></li>
<li><p>ANOVA generalizes the t-test beyond 2 groups, it is used to compare 3 or more groups</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-2"><a href=""></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb8-3"><a href=""></a><span class="fu">head</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
1 Adelie  Torgersen           39.1          18.7               181        3750
2 Adelie  Torgersen           39.5          17.4               186        3800
3 Adelie  Torgersen           40.3          18                 195        3250
4 Adelie  Torgersen           NA            NA                  NA          NA
5 Adelie  Torgersen           36.7          19.3               193        3450
6 Adelie  Torgersen           39.3          20.6               190        3650
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">summary</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      species          island    bill_length_mm  bill_depth_mm  
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
                                 Mean   :43.92   Mean   :17.15  
                                 3rd Qu.:48.50   3rd Qu.:18.70  
                                 Max.   :59.60   Max.   :21.50  
                                 NA's   :2       NA's   :2      
 flipper_length_mm  body_mass_g       sex           year     
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007  
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  
 Median :197.0     Median :4050   NA's  : 11   Median :2008  
 Mean   :200.9     Mean   :4202                Mean   :2008  
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  
 Max.   :231.0     Max.   :6300                Max.   :2009  
 NA's   :2         NA's   :2                                 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y=</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb12-2"><a href=""></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The question : <strong>Does species help explain flipper lenght ?</strong></p>
<p>Assumptions :</p>
<ul>
<li><p>The population from which samples are drawn should be <strong>normally distributed</strong></p></li>
<li><p><strong>Independence</strong> of cases : the sample cases should be independent of each other.</p></li>
<li><p><strong>Homogeneity of variance</strong> : Homogeneity means that the variance among the groups should be approximately equal.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href=""></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>species, <span class="at">ncol =</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href=""></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href=""></a>  <span class="fu">summarise</span>(<span class="fu">var</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  species   `var(flipper_length_mm, na.rm = TRUE)`
  &lt;fct&gt;                                      &lt;dbl&gt;
1 Adelie                                      42.8
2 Chinstrap                                   50.9
3 Gentoo                                      42.1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>model <span class="ot">=</span> <span class="fu">aov</span>(flipper_length_mm <span class="sc">~</span> species, <span class="at">data =</span> penguins)</span>
<span id="cb16-2"><a href=""></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
species       2  52473   26237   594.8 &lt;2e-16 ***
Residuals   339  14953      44                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
2 observations deleted due to missingness</code></pre>
</div>
</div>
<h3 class="scrollable" id="second-example-anova">Second example ANOVA</h3>
<h4 id="one-way">One way</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>crop.data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"data_raw/crop.data.csv"</span>)</span>
<span id="cb18-2"><a href=""></a><span class="fu">head</span>(crop.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  density block fertilizer    yield
1       1     1          1 177.2287
2       2     2          1 177.5500
3       1     3          1 176.4085
4       2     4          1 177.7036
5       1     1          1 177.1255
6       2     2          1 176.7783</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">summary</span>(crop.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    density        block        fertilizer     yield      
 Min.   :1.0   Min.   :1.00   Min.   :1    Min.   :175.4  
 1st Qu.:1.0   1st Qu.:1.75   1st Qu.:1    1st Qu.:176.5  
 Median :1.5   Median :2.50   Median :2    Median :177.1  
 Mean   :1.5   Mean   :2.50   Mean   :2    Mean   :177.0  
 3rd Qu.:2.0   3rd Qu.:3.25   3rd Qu.:3    3rd Qu.:177.4  
 Max.   :2.0   Max.   :4.00   Max.   :3    Max.   :179.1  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>one.way <span class="ot">&lt;-</span> <span class="fu">aov</span>(yield <span class="sc">~</span> fertilizer, <span class="at">data =</span> crop.data)</span>
<span id="cb22-2"><a href=""></a><span class="fu">summary</span>(one.way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fertilizer   1   5.74   5.743   14.91 0.000207 ***
Residuals   94  36.21   0.385                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In this one-way ANOVA setup, we test if fertilizer type has a significant impact on the final crop yield</p>
<p><strong>Yes ! It does !</strong></p>
<h4 id="two-way">Two-way</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a>anova2way <span class="ot">&lt;-</span> <span class="fu">aov</span>(yield <span class="sc">~</span> fertilizer <span class="sc">+</span> density, <span class="at">data =</span> crop.data)</span>
<span id="cb24-2"><a href=""></a><span class="fu">summary</span>(anova2way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fertilizer   1  5.743   5.743   17.18 7.49e-05 ***
density      1  5.122   5.122   15.32 0.000173 ***
Residuals   93 31.089   0.334                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The two-way ANOVA : extension of the one-way ANOVA that examines the influence of two different categorical independent variables on one continuous dependent variable.</p>
<p>The two-way ANOVA not only aims at assessing the main effect of each independent variable but also if there is any interaction between them.</p>
</section>
<section id="post-hoc-test" class="slide level2 scrollable">
<h2>Post hoc test</h2>
<p>In order to find out exactly which groups are different from each other, we must conduct a <strong>post hoc test</strong>.</p>
<ul>
<li><p><strong>The Tukey HSD test</strong> : compare all groups to each other</p></li>
<li><p><strong>The Dunnett test</strong> : compare with a reference group.</p></li>
</ul>
<h3 id="the-tukey-test">The Tukey test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">TukeyHSD</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = flipper_length_mm ~ species, data = penguins)

$species
                      diff       lwr       upr p adj
Chinstrap-Adelie  5.869887  3.586583  8.153191     0
Gentoo-Adelie    27.233349 25.334376 29.132323     0
Gentoo-Chinstrap 21.363462 19.000841 23.726084     0</code></pre>
</div>
</div>
<p>All three ajusted p-values are smaller than 0.05 !</p>
<p><span class="math inline">\(\to\)</span> We reject H0, which means that all species are significantly different in terms of flippers length</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="slides_en_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"><h3 id="the-dunnett-test">The Dunnett test</h3>
<p>Comparisons with a reference group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a><span class="fu">library</span>(multcomp)</span>
<span id="cb29-2"><a href=""></a>post_dunnet <span class="ot">&lt;-</span> <span class="fu">glht</span>(model,<span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">species =</span> <span class="st">"Dunnett"</span>))</span>
<span id="cb29-3"><a href=""></a><span class="fu">summary</span>(post_dunnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = flipper_length_mm ~ species, data = penguins)

Linear Hypotheses:
                        Estimate Std. Error t value Pr(&gt;|t|)    
Chinstrap - Adelie == 0   5.8699     0.9699   6.052 7.59e-09 ***
Gentoo - Adelie == 0     27.2333     0.8067  33.760  &lt; 1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
</section>
<section id="test-for-normality" class="slide level2 scrollable">
<h2>Test for Normality</h2>
<ol type="1">
<li><p>Create a histogram</p></li>
<li><p>Perform a Shapiro-Wilk Test</p></li>
<li><p>Perform a Kolmogorov-Smirnov Test</p></li>
</ol>
<p>Produce some data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb31-2"><a href=""></a>normal_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">500</span>)</span>
<span id="cb31-3"><a href=""></a>non_normal_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">500</span>, <span class="at">rate=</span><span class="dv">3</span>)</span>
<span id="cb31-4"><a href=""></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a Histogram</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a><span class="fu">hist</span>(normal_data, <span class="at">col=</span><span class="st">'steelblue'</span>, <span class="at">main=</span><span class="st">'Normal'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-18-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="fu">hist</span>(non_normal_data, <span class="at">col=</span><span class="st">'steelblue'</span>, <span class="at">main=</span><span class="st">'Non-normal'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<h3 id="shapiro-wilk-test">Shapiro-Wilk Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">shapiro.test</span>(normal_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  normal_data
W = 0.9957, p-value = 0.1881</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">shapiro.test</span>(non_normal_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  non_normal_data
W = 0.84498, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<h3 id="kolmogorov-smirnov-test">Kolmogorov-Smirnov Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="fu">ks.test</span>(normal_data, <span class="st">'pnorm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  normal_data
D = 0.031951, p-value = 0.6871
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">ks.test</span>(non_normal_data, <span class="st">'pnorm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  non_normal_data
D = 0.50026, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
</div>
</section>
<section id="test-for-homogeneity-of-variances" class="slide level2 scrollable">
<h2>Test for homogeneity of variances</h2>
<p>Bartlett test</p>
<p>levene test</p>
</section>
<section id="pearson-correlation" class="slide level2 scrollable">
<h2>Pearson correlation</h2>
<p>…</p>
</section>
<section id="simple-linear-regression" class="slide level2 scrollable">
<h2>Simple Linear regression</h2>
<p>…</p>
</section>
<section id="multiple-linear-regression" class="slide level2 scrollable">
<h2>Multiple Linear regression</h2>
<p>Few packages that are very useful to perform <strong>multiple linear regression</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-2"><a href=""></a><span class="fu">library</span>(GGally)</span>
<span id="cb42-3"><a href=""></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We “produce” data (FYI)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb43-2"><a href=""></a>x1 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">60</span>,<span class="dv">100</span>,<span class="dv">300</span>)</span>
<span id="cb43-3"><a href=""></a>x2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">60</span>,<span class="dv">20</span>,<span class="dv">120</span>)</span>
<span id="cb43-4"><a href=""></a>y <span class="ot">=</span> <span class="dv">20</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>x1 <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">60</span>,<span class="dv">0</span>,<span class="dv">40</span>)</span>
<span id="cb43-5"><a href=""></a>df <span class="ot">=</span> <span class="fu">tibble</span>(x1,x2,y)</span>
<span id="cb43-6"><a href=""></a>new_x1 <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">120</span>, <span class="at">to =</span> <span class="dv">300</span>, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb43-7"><a href=""></a>new_x2 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">110</span>)</span>
<span id="cb43-8"><a href=""></a>new_data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x1 =</span> new_x1, <span class="at">x2 =</span> new_x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="the-data">The data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 3
      x1    x2     y
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  137.  97.0  205.
 2  240. 109.   737.
 3  215.  82.5  603.
 4  134.  46.0  423.
 5  289. 106.   878.
 6  289.  63.7  951.
 7  126.  58.8  267.
 8  267.  66.2  869.
 9  194.  41.9  672.
10  210.  26.6  744.
# ℹ 50 more rows</code></pre>
</div>
</div>
<h3 id="assumptions">Assumptions</h3>
<p>Model of the form <span class="math inline">\(y \sim \beta_0+\displaystyle\sum_{k=1}^p \beta_k x_k+\epsilon_i\)</span></p>
<ul>
<li>Assumes Linear relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x_1, x_2, \ldots, x_p\)</span></li>
<li>Assumes the irreducible error (<span class="math inline">\(\epsilon_i\)</span>) is normally distributed</li>
<li>Assumes homoscedacisity, that is <span class="math inline">\(\epsilon_i\)</span> does not depend on <span class="math inline">\(x_1, x_2, \ldots, x_p\)</span></li>
<li>In this model, the variables <span class="math inline">\(x_i\)</span> do not interact</li>
<li>Always watch out for outliers !</li>
</ul>
<h3 id="a-first-look-at-the-data">A first look at the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="fu">ggpairs</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-27-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="the-model">The model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a>model <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> df)</span>
<span id="cb47-2"><a href=""></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-72.286 -34.102  -2.892  30.163  87.738 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -35.39079   24.19773  -1.463    0.149    
x1            4.15232    0.08981  46.235   &lt;2e-16 ***
x2           -2.66124    0.19657 -13.539   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 43.2 on 57 degrees of freedom
Multiple R-squared:  0.9772,    Adjusted R-squared:  0.9764 
F-statistic:  1220 on 2 and 57 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<h3 id="few-graphs-to-undersand-the-model">Few graphs to undersand the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-29-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-29-2.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-29-3.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides_en_files/figure-revealjs/unnamed-chunk-29-4.png" width="960"></p>
</figure>
</div>
</div>
</div>
<h3 id="predictions">Predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>new_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
      x1    x2
   &lt;dbl&gt; &lt;dbl&gt;
 1  120  101. 
 2  129.  54.1
 3  139.  74.4
 4  148.  90.4
 5  158. 107. 
 6  167. 106. 
 7  177.  56.7
 8  186.  71.3
 9  196.  41.9
10  205.  58.5
11  215.  86.4
12  224.  36.4
13  234.  50.1
14  243.  34.1
15  253.  89.1
16  262.  31.1
17  272.  33.4
18  281.  52.5
19  291.  33.3
20  300   80.6</code></pre>
</div>
</div>
<p><span class="math inline">\(\to\)</span> We want to “predict” the <strong>y</strong> according to these x1 and x2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a>fit <span class="ot">=</span> <span class="fu">predict</span>(model,new_data)</span>
<span id="cb52-2"><a href=""></a>new_data<span class="sc">$</span>predict <span class="ot">=</span> fit</span>
<span id="cb52-3"><a href=""></a>new_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
      x1    x2 predict
   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1  120  101.     193.
 2  129.  54.1    358.
 3  139.  74.4    344.
 4  148.  90.4    340.
 5  158. 107.     337.
 6  167. 106.     377.
 7  177.  56.7    548.
 8  186.  71.3    548.
 9  196.  41.9    666.
10  205.  58.5    661.
11  215.  86.4    626.
12  224.  36.4    799.
13  234.  50.1    802.
14  243.  34.1    883.
15  253.  89.1    777.
16  262.  31.1    970.
17  272.  33.4   1003.
18  281.  52.5    992.
19  291.  33.3   1082.
20  300   80.6    996.</code></pre>
</div>
</div>
</section>
<section id="nonparametric-statistical-tests" class="slide level2 scrollable">
<h2>Nonparametric statistical tests</h2>
<h3 id="overview">Overview</h3>
<ul>
<li><p><strong>Parametric tests</strong> have requirements about the nature or shape of the populations involved</p></li>
<li><p><strong>Nonparametric tests</strong> do not require that samples come from populations with normal distributions or have any other particular distributions. Nonparametric tests are called distribution-free tests.</p></li>
</ul>
<h3 id="the-postive-sides-of-nonparametric-tests">The postive sides of Nonparametric tests</h3>
<ul>
<li><p>Nonparametric methods can be <strong>applied to a wide variety of situations</strong> because they do not have the more rigid requirements of the corresponding parametric methods.</p></li>
<li><p>Unlike parametric methods, nonparametric methods can <strong>often be applied to categorical data</strong>.</p></li>
<li><p>Nonparametric methods usually involve <strong>simpler computations</strong> than the corresponding parametric methods.</p></li>
</ul>
<h3 id="the-negative-sides-of-nonparametric-tests">The negative sides of Nonparametric tests</h3>
<ul>
<li><p>Nonparametric methods tend to <strong>waste information</strong></p></li>
<li><p>Nonparametric tests are <strong>not as efficient</strong> as parametric tests</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>With a nonparametric test we need <strong>stronger evidence</strong> (such as a larger sample or greater differences) before we reject a null hypothesis.</p>
</div>
</div>
</div>
<h3 id="definitions">Definitions</h3>
<ul>
<li><p>Data are <strong>sorted</strong> when they are arranged according to some criterion.</p></li>
<li><p>A <strong>rank</strong> is a number assigned to an individual sample item according to its order in the sorted list. The first item is assigned a rank of 1, the second is assigned a rank of 2, and so on.</p></li>
</ul>
</section></section>
<section>
<section id="multivariate-analysis" class="title-slide slide level1 center">
<h1>Multivariate Analysis</h1>

</section>
<section id="what-is-multivariate-analysis" class="slide level2 scrollable">
<h2>What is multivariate analysis ?</h2>
<ul>
<li>Univariate statistics
<ul>
<li>focus on a single variable of interest (at a time)</li>
<li>estimate population parameters ( <span class="math inline">\(\pi, \mu, \sigma^2, \ldots\)</span> )</li>
<li>comparison of two or more groups</li>
</ul></li>
<li>Bivariate statistics
<ul>
<li>focus on interdependencies of two variables</li>
<li>correlation and co-occurrence</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>Regression modelling
<ul>
<li>predict single target variable (“dependent”)</li>
<li>based on multiple other variables (“independent”)</li>
</ul></li>
<li>Multivariate statistics
<ul>
<li>combined effects of many variables</li>
<li>correlations and distribution patterns</li>
<li>often “unsupervised” : no target variable or comparison groups</li>
</ul></li>
</ul>
<h3 id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h3>
<ul>
<li>Intuition</li>
<li>Four definitions</li>
<li>Practical examples</li>
<li>Mathematical example</li>
<li>Case study</li>
</ul>
<h3 id="pca---goals">PCA - Goals</h3>
<ol type="1">
<li><p><strong>Dimension reduction</strong> to a few dimensions while explaining most of the variance</p></li>
<li><p><strong>Find one-dimensional</strong> index that separates objects best</p></li>
</ol>
<h3 id="pca---intuition">PCA - Intuition</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Find low-dimensional projection with largest spread</p>
</div>
</div>
</div>
<p><img data-src="./img/pca-intution-1.png"></p>
<p><img data-src="./img/pca-intution-2.png"></p>
<p><img data-src="./img/pca-intution-3.png"></p>
<ul>
<li><p>Dimension reduction : Only keep coordinate of first (few) <strong>P</strong>rincipal <strong>C</strong>omponent (PC)</p></li>
<li><p>Rotated basis :</p>
<ul>
<li>Vector 1 : Largest variance (1st PC)</li>
<li>Vector 2 : Perpendicular (2nd PC)</li>
</ul></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">x1</th>
<th style="text-align: left;">x2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Std. Basis</td>
<td style="text-align: left;">0.3</td>
<td style="text-align: left;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC Basis</td>
<td style="text-align: left;">0.7</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">After Dim. Reduc.</td>
<td style="text-align: left;">0.7</td>
<td style="text-align: left;">-</td>
</tr>
</tbody>
</table>
<h3 id="pca---otthogonal-directions">PCA - Otthogonal directions</h3>
<ul>
<li><p><strong>PC</strong> 1 is the direction with largest variance</p></li>
<li><p><strong>PC</strong> 2 is :</p>
<ul>
<li>perpendicular to PC 1</li>
<li>again largest variance</li>
</ul></li>
<li><p><strong>PC</strong> 3 is :</p>
<ul>
<li>perpendicular to PC 1, PC 2</li>
<li>again largest variance</li>
</ul></li>
<li><p>…</p></li>
</ul>
<p><img data-src="./img/pca-orthogonal-directions.png"></p>
<h3 id="which-kinds-of-data">Which kinds of data ?</h3>
<p><strong>PCA</strong> applies to data tables where : - rows are considered as individuals - and columns as quantitative variables</p>
<h3 id="example-dataset-iris">Example : Dataset Iris</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a>data <span class="ot">=</span> iris</span>
<span id="cb54-2"><a href=""></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1            5.1         3.5          1.4         0.2     setosa
2            4.9         3.0          1.4         0.2     setosa
3            4.7         3.2          1.3         0.2     setosa
4            4.6         3.1          1.5         0.2     setosa
5            5.0         3.6          1.4         0.2     setosa
6            5.4         3.9          1.7         0.4     setosa
7            4.6         3.4          1.4         0.3     setosa
8            5.0         3.4          1.5         0.2     setosa
9            4.4         2.9          1.4         0.2     setosa
10           4.9         3.1          1.5         0.1     setosa
11           5.4         3.7          1.5         0.2     setosa
12           4.8         3.4          1.6         0.2     setosa
13           4.8         3.0          1.4         0.1     setosa
14           4.3         3.0          1.1         0.1     setosa
15           5.8         4.0          1.2         0.2     setosa
16           5.7         4.4          1.5         0.4     setosa
17           5.4         3.9          1.3         0.4     setosa
18           5.1         3.5          1.4         0.3     setosa
19           5.7         3.8          1.7         0.3     setosa
20           5.1         3.8          1.5         0.3     setosa
21           5.4         3.4          1.7         0.2     setosa
22           5.1         3.7          1.5         0.4     setosa
23           4.6         3.6          1.0         0.2     setosa
24           5.1         3.3          1.7         0.5     setosa
25           4.8         3.4          1.9         0.2     setosa
26           5.0         3.0          1.6         0.2     setosa
27           5.0         3.4          1.6         0.4     setosa
28           5.2         3.5          1.5         0.2     setosa
29           5.2         3.4          1.4         0.2     setosa
30           4.7         3.2          1.6         0.2     setosa
31           4.8         3.1          1.6         0.2     setosa
32           5.4         3.4          1.5         0.4     setosa
33           5.2         4.1          1.5         0.1     setosa
34           5.5         4.2          1.4         0.2     setosa
35           4.9         3.1          1.5         0.2     setosa
36           5.0         3.2          1.2         0.2     setosa
37           5.5         3.5          1.3         0.2     setosa
38           4.9         3.6          1.4         0.1     setosa
39           4.4         3.0          1.3         0.2     setosa
40           5.1         3.4          1.5         0.2     setosa
41           5.0         3.5          1.3         0.3     setosa
42           4.5         2.3          1.3         0.3     setosa
43           4.4         3.2          1.3         0.2     setosa
44           5.0         3.5          1.6         0.6     setosa
45           5.1         3.8          1.9         0.4     setosa
46           4.8         3.0          1.4         0.3     setosa
47           5.1         3.8          1.6         0.2     setosa
48           4.6         3.2          1.4         0.2     setosa
49           5.3         3.7          1.5         0.2     setosa
50           5.0         3.3          1.4         0.2     setosa
51           7.0         3.2          4.7         1.4 versicolor
52           6.4         3.2          4.5         1.5 versicolor
53           6.9         3.1          4.9         1.5 versicolor
54           5.5         2.3          4.0         1.3 versicolor
55           6.5         2.8          4.6         1.5 versicolor
56           5.7         2.8          4.5         1.3 versicolor
57           6.3         3.3          4.7         1.6 versicolor
58           4.9         2.4          3.3         1.0 versicolor
59           6.6         2.9          4.6         1.3 versicolor
60           5.2         2.7          3.9         1.4 versicolor
61           5.0         2.0          3.5         1.0 versicolor
62           5.9         3.0          4.2         1.5 versicolor
63           6.0         2.2          4.0         1.0 versicolor
64           6.1         2.9          4.7         1.4 versicolor
65           5.6         2.9          3.6         1.3 versicolor
66           6.7         3.1          4.4         1.4 versicolor
67           5.6         3.0          4.5         1.5 versicolor
68           5.8         2.7          4.1         1.0 versicolor
69           6.2         2.2          4.5         1.5 versicolor
70           5.6         2.5          3.9         1.1 versicolor
71           5.9         3.2          4.8         1.8 versicolor
72           6.1         2.8          4.0         1.3 versicolor
73           6.3         2.5          4.9         1.5 versicolor
74           6.1         2.8          4.7         1.2 versicolor
75           6.4         2.9          4.3         1.3 versicolor
76           6.6         3.0          4.4         1.4 versicolor
77           6.8         2.8          4.8         1.4 versicolor
78           6.7         3.0          5.0         1.7 versicolor
79           6.0         2.9          4.5         1.5 versicolor
80           5.7         2.6          3.5         1.0 versicolor
81           5.5         2.4          3.8         1.1 versicolor
82           5.5         2.4          3.7         1.0 versicolor
83           5.8         2.7          3.9         1.2 versicolor
84           6.0         2.7          5.1         1.6 versicolor
85           5.4         3.0          4.5         1.5 versicolor
86           6.0         3.4          4.5         1.6 versicolor
87           6.7         3.1          4.7         1.5 versicolor
88           6.3         2.3          4.4         1.3 versicolor
89           5.6         3.0          4.1         1.3 versicolor
90           5.5         2.5          4.0         1.3 versicolor
91           5.5         2.6          4.4         1.2 versicolor
92           6.1         3.0          4.6         1.4 versicolor
93           5.8         2.6          4.0         1.2 versicolor
94           5.0         2.3          3.3         1.0 versicolor
95           5.6         2.7          4.2         1.3 versicolor
96           5.7         3.0          4.2         1.2 versicolor
97           5.7         2.9          4.2         1.3 versicolor
98           6.2         2.9          4.3         1.3 versicolor
99           5.1         2.5          3.0         1.1 versicolor
100          5.7         2.8          4.1         1.3 versicolor
101          6.3         3.3          6.0         2.5  virginica
102          5.8         2.7          5.1         1.9  virginica
103          7.1         3.0          5.9         2.1  virginica
104          6.3         2.9          5.6         1.8  virginica
105          6.5         3.0          5.8         2.2  virginica
106          7.6         3.0          6.6         2.1  virginica
107          4.9         2.5          4.5         1.7  virginica
108          7.3         2.9          6.3         1.8  virginica
109          6.7         2.5          5.8         1.8  virginica
110          7.2         3.6          6.1         2.5  virginica
111          6.5         3.2          5.1         2.0  virginica
112          6.4         2.7          5.3         1.9  virginica
113          6.8         3.0          5.5         2.1  virginica
114          5.7         2.5          5.0         2.0  virginica
115          5.8         2.8          5.1         2.4  virginica
116          6.4         3.2          5.3         2.3  virginica
117          6.5         3.0          5.5         1.8  virginica
118          7.7         3.8          6.7         2.2  virginica
119          7.7         2.6          6.9         2.3  virginica
120          6.0         2.2          5.0         1.5  virginica
121          6.9         3.2          5.7         2.3  virginica
122          5.6         2.8          4.9         2.0  virginica
123          7.7         2.8          6.7         2.0  virginica
124          6.3         2.7          4.9         1.8  virginica
125          6.7         3.3          5.7         2.1  virginica
126          7.2         3.2          6.0         1.8  virginica
127          6.2         2.8          4.8         1.8  virginica
128          6.1         3.0          4.9         1.8  virginica
129          6.4         2.8          5.6         2.1  virginica
130          7.2         3.0          5.8         1.6  virginica
131          7.4         2.8          6.1         1.9  virginica
132          7.9         3.8          6.4         2.0  virginica
133          6.4         2.8          5.6         2.2  virginica
134          6.3         2.8          5.1         1.5  virginica
135          6.1         2.6          5.6         1.4  virginica
136          7.7         3.0          6.1         2.3  virginica
137          6.3         3.4          5.6         2.4  virginica
138          6.4         3.1          5.5         1.8  virginica
139          6.0         3.0          4.8         1.8  virginica
140          6.9         3.1          5.4         2.1  virginica
141          6.7         3.1          5.6         2.4  virginica
142          6.9         3.1          5.1         2.3  virginica
143          5.8         2.7          5.1         1.9  virginica
144          6.8         3.2          5.9         2.3  virginica
145          6.7         3.3          5.7         2.5  virginica
146          6.7         3.0          5.2         2.3  virginica
147          6.3         2.5          5.0         1.9  virginica
148          6.5         3.0          5.2         2.0  virginica
149          6.2         3.4          5.4         2.3  virginica
150          5.9         3.0          5.1         1.8  virginica</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>150 individuals (rows) : flowers</li>
<li>5 variables 30 variables (columns) :
<ul>
<li>4 continuous variables</li>
<li>1 categorical variable</li>
</ul></li>
</ul>
</div></div>
<p>The data table can be seen as :</p>
<ul>
<li><p>a set of rows</p></li>
<li><p>OR a set of columns</p></li>
</ul>
<p><strong>Studying individuals</strong> :</p>
<ul>
<li><p>When can we say that 2 individuals are similar with respect to all the variables ?</p></li>
<li><p>If there are many individuals, is it possible to categorize them ?</p></li>
</ul>
<h3 id="the-clouds-of-individuals">The clouds of individuals</h3>
<ul>
<li>1 individual = 1 row = 1 point in <span class="math inline">\(\mathbb{R}^k\)</span> (for iris, <span class="math inline">\(k=5\)</span>)
<ul>
<li>If <span class="math inline">\(k=1\)</span> : axial representation</li>
<li>If <span class="math inline">\(k=2\)</span> : scatter plot</li>
<li>If <span class="math inline">\(k=3\)</span> : 3D representation (more difficult)</li>
<li>if <span class="math inline">\(k=4\)</span> : impossible to “see”</li>
</ul></li>
<li><strong>Notion of similiarity</strong> : Distance between indiduals i and j</li>
</ul>
<p><span class="math display">\[d^2\left(i, j\right)=\sum_{\ell=1}^k\left(x_{i \ell}-x_{j \ell}\right)^2\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Studying the individuals = Studying the shape of the clouds of individuals</p>
</div>
</div>
</div>
<h3 id="centering-standardizing-data">Centering – standardizing data</h3>
<ul>
<li><p>Centering does not modify the shape of the cloud</p></li>
<li><p>Standardizing data is necessary if units are different between variables</p></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Principal component analysis (PCA) = Studying the standardized data set</p>
</div>
</div>
</div>
<h3 id="fitting-the-cloud-of-individuals">Fitting the cloud of individuals</h3>
<p><strong>PCA</strong> searches for the best summary space for optimal visualization of the clouds of individuals.</p>
<p>Viewpoint quality :</p>
<ul>
<li><p>faithfully reproduce the cloud’s shape</p></li>
<li><p>best representation of diversity, variability</p></li>
<li><p>doesn’t distort distances between individuals</p></li>
</ul>
<p>How to quantify the quality of a viewpoint ?</p>
<p>notion of dispersion, of variability, also called <strong>inertia</strong></p>
<p><strong>Inertia</strong> is the variance generalized to several dimensions.</p>
</section>
<section id="first-example-of-pca" class="slide level2 scrollable">
<h2>First example of PCA</h2>
<h3 id="data">Data</h3>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(P\)</span> <span class="math inline">\(\left(\text{cm}\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{max}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{min}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">12,04</td>
<td style="text-align: left;">23,7</td>
<td style="text-align: left;">5,9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">17,18</td>
<td style="text-align: left;">15,5</td>
<td style="text-align: left;">-1,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">11,83</td>
<td style="text-align: left;">13,1</td>
<td style="text-align: left;">2,8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">6,23</td>
<td style="text-align: left;">13,5</td>
<td style="text-align: left;">-2,4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">16,99</td>
<td style="text-align: left;">21,1</td>
<td style="text-align: left;">7,2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">3,87</td>
<td style="text-align: left;">20,3</td>
<td style="text-align: left;">-0,9</td>
</tr>
</tbody>
</table>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(P\)</span> <span class="math inline">\(\left(\text{cm}\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{max}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{min}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">12,04</td>
<td style="text-align: left;">23,7</td>
<td style="text-align: left;">5,9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">17,18</td>
<td style="text-align: left;">15,5</td>
<td style="text-align: left;">-1,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">11,83</td>
<td style="text-align: left;">13,1</td>
<td style="text-align: left;">2,8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">6,23</td>
<td style="text-align: left;">13,5</td>
<td style="text-align: left;">-2,4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">16,99</td>
<td style="text-align: left;">21,1</td>
<td style="text-align: left;">7,2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">3,87</td>
<td style="text-align: left;">20,3</td>
<td style="text-align: left;">-0,9</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: left;">11,36</td>
<td style="text-align: left;">17,87</td>
<td style="text-align: left;">1,8</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
<td style="text-align: left;">4,98</td>
<td style="text-align: left;">4,04</td>
<td style="text-align: left;">3,76</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[x_{i k}=\frac{x_{i k}-\overline{X_k}}{\sigma_k}\]</span></p>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(P\)</span> <span class="math inline">\(\left(\text{cm}\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{max}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(T_{\text{min}}\)</span> <span class="math inline">\(\left(^\circ C\right)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">0,14</td>
<td style="text-align: left;">1,44</td>
<td style="text-align: left;">1,09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">1,17</td>
<td style="text-align: left;">-0,59</td>
<td style="text-align: left;">-0,96</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">0,10</td>
<td style="text-align: left;">-1,18</td>
<td style="text-align: left;">0,27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">-1,03</td>
<td style="text-align: left;">-1,08</td>
<td style="text-align: left;">-1,12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">1,13</td>
<td style="text-align: left;">0,80</td>
<td style="text-align: left;">1,44</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">-1,50</td>
<td style="text-align: left;">0,60</td>
<td style="text-align: left;">-0,72</td>
</tr>
</tbody>
</table>
<h3 id="correlation-matrix">Correlation Matrix</h3>
<table class="caption-top">
<colgroup>
<col style="width: 21%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(P\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{max}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{min}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(r\left(P, T_{\text{max} }\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(P, T_{\text{min} }\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{\text{max} }\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{max} }, P\right)\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{max} }, T_{\text{min} }\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{\text{min} }\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{min} }, P\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\left(T_{\text{min} }, T_{\text{max} }\right)\)</span></td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[r\left(P, T_{\text{max} }\right) = r\left(T_{\text{max} }, P\right)\]</span></p>
<p><span class="math display">\[C = \frac{1}{N} \ X_{cr}^T \ X_{cr}\]</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(P\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{max} }\)</span></th>
<th style="text-align: center;"><span class="math inline">\(T_{\text{min} }\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0,09</td>
<td style="text-align: center;">0,49</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{\text{max} }\)</span></td>
<td style="text-align: center;">0,09</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0,62</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{\text{min} }\)</span></td>
<td style="text-align: center;">0,49</td>
<td style="text-align: center;">0,62</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<h3 id="eigenvalues-and-eigenvectors">Eigenvalues and Eigenvectors</h3>
<p><span class="math display">\[C =
\begin{pmatrix}
1 &amp; 0.09 &amp; 0.49 \\
0.09 &amp; 1 &amp; 0.62 \\
0.49 &amp; 0.62 &amp; 1
\end{pmatrix}\]</span></p>
<p>How do we do it now ?</p>
<h3 id="eigenvalues-and-eigenvectors-1">Eigenvalues and Eigenvectors</h3>
<p>We find</p>
<ul>
<li><span class="math inline">\(\lambda_1 = 1,83\quad\)</span> with <span class="math inline">\(\quad v_1=\begin{pmatrix} 0.46 \\ 0.56 \\ 0.69 \end{pmatrix}\)</span></li>
<li><span class="math inline">\(\lambda_2 = 0.92\quad\)</span> with <span class="math inline">\(\quad v_2=\begin{pmatrix} 0.79 \\ -0.61 \\ -0.03 \end{pmatrix}\)</span></li>
<li><span class="math inline">\(\lambda_3 = 0.25\quad\)</span> with <span class="math inline">\(\quad v_3=\begin{pmatrix} 0.41 \\ 0.56 \\ -0.72 \end{pmatrix}\)</span></li>
</ul>
<h3 id="inertia-generalized-variance">Inertia (generalized variance)</h3>
<p><span class="math display">\[
\mbox{Total inertia} = \sum \mbox{eigenvalues} \ = 3
\]</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Eigenvalue</th>
<th style="text-align: left;">Inertia (%)</th>
<th style="text-align: left;">Inertia Cumul. (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\lambda_1\)</span></td>
<td style="text-align: left;">1,83</td>
<td style="text-align: left;">61,17</td>
<td style="text-align: left;">61,17</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\lambda_2\)</span></td>
<td style="text-align: left;">0,92</td>
<td style="text-align: left;">30,51</td>
<td style="text-align: left;">91,68</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\lambda_3\)</span></td>
<td style="text-align: left;">0,25</td>
<td style="text-align: left;">8,32</td>
<td style="text-align: left;">100,00</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[X_{cr} =\left[\begin{array}{rrr}0,14 &amp; 1,44 &amp; 1,09 \\ 1,17 &amp; -0,59 &amp; -0,96 \\ 0,10 &amp; -1,18 &amp; 0,27 \\ -1,03 &amp; -1,08 &amp; -1,12 \\ 1,13 &amp; 0,80 &amp; 1,44 \\ -1,50 &amp; 0,60 &amp; -0,72\end{array}\right]\]</span></p>
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="./img/acp-ex-1.png"></p>
</div><div class="column" style="width:25%;">
<p><img data-src="./img/acp-ex-2.png"></p>
</div><div class="column" style="width:25%;">
<p><img data-src="./img/acp-ex-3.png"></p>
</div></div>
<h3 id="principal-components">Principal components</h3>
<p><span class="math display">\[X_{cr} =\left[\begin{array}{rrr}0,14 &amp; 1,44 &amp; 1,09 \\ 1,17 &amp; -0,59 &amp; -0,96 \\ 0,10 &amp; -1,18 &amp; 0,27 \\ -1,03 &amp; -1,08 &amp; -1,12 \\ 1,13 &amp; 0,80 &amp; 1,44 \\ -1,50 &amp; 0,60 &amp; -0,72\end{array}\right]\]</span></p>
<p><span class="math display">\[v_1=\begin{pmatrix} 0.46 \\ 0.56 \\ 0.69 \end{pmatrix} \qquad v_2=\begin{pmatrix} 0.79 \\ -0.61 \\ -0.03 \end{pmatrix}\]</span></p>
<p>We do <span class="math inline">\(X_{cr} v_1\)</span> and <span class="math inline">\(X_{cr} v_2\)</span></p>
<p>We get <span class="math display">\[\begin{pmatrix} 1,63 \\ -0,45 \\ -0,43 \\ -1,85 \\ 1,96 \\ -0,85 \end{pmatrix}\]</span> and <span class="math display">\[\begin{pmatrix}-0,81 \\ 1,31 \\ 0,79 \\ -0,12 \\ 0,37 \\ -1,54\end{pmatrix}\]</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><span class="math inline">\(\mathrm{F}_1\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\mathrm{F}_2\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\mathrm{F}_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ajaccio</td>
<td style="text-align: left;">1,63</td>
<td style="text-align: left;">-0,81</td>
<td style="text-align: left;">0,07</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brest</td>
<td style="text-align: left;">-0,45</td>
<td style="text-align: left;">1,31</td>
<td style="text-align: left;">0,84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dunkerque</td>
<td style="text-align: left;">-0,43</td>
<td style="text-align: left;">0,79</td>
<td style="text-align: left;">-0,81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nancy</td>
<td style="text-align: left;">-1,85</td>
<td style="text-align: left;">-0,12</td>
<td style="text-align: left;">-0,21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nice</td>
<td style="text-align: left;">1,96</td>
<td style="text-align: left;">0,37</td>
<td style="text-align: left;">-0,13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toulouse</td>
<td style="text-align: left;">-0,85</td>
<td style="text-align: left;">-1,54</td>
<td style="text-align: left;">0,24</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: left;">1,83</td>
<td style="text-align: left;">0,92</td>
<td style="text-align: left;">0,25</td>
</tr>
</tbody>
</table>
<h3 id="cercle-de-corrélation">Cercle de corrélation</h3>
<p><span class="math inline">\(r(P,F_1) = \mbox{First coordinate of } v_1 \times \sqrt{\lambda_1} = 0.62\)</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(F_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(F_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(F_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;">0,62</td>
<td style="text-align: center;">0,76</td>
<td style="text-align: center;">0,21</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{\text{max} }\)</span></td>
<td style="text-align: center;">0,76</td>
<td style="text-align: center;"><span class="math inline">\(-0,59\)</span></td>
<td style="text-align: center;">0,28</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{\min }\)</span></td>
<td style="text-align: center;">0,93</td>
<td style="text-align: center;"><span class="math inline">\(-0,03\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-0,36\)</span></td>
</tr>
</tbody>
</table>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="slides_en_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="slides_en_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="slides_en_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="slides_en_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    document.addEventListener("DOMContentLoaded", function() {

      const slideNumberDiv = document.getElementById("custom-slide-number");

    

      function updateSlideNumber() {

        const indices = Reveal.getIndices();

        const slideNumber = indices.h + 1 + '/' + Reveal.getTotalSlides();

        slideNumberDiv.innerText = slideNumber;

      }

    

      Reveal.on('slidechanged', updateSlideNumber);

      updateSlideNumber();

    });

    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>